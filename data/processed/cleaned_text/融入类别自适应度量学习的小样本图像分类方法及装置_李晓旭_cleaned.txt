本发明公开了一种融入类别自适应度量学习的小样本图像分类方法及装置，由数据预处理模块、构建网络模型模块、训练模型参数模块和测试模型性能模块组成。本发明提供的融入类别自适应度量学习的小样本图像分类方法及装置，为每个类别构建一个度量模块，通过对类内共性特征的学习，建立基于类内共性特征的度量，利用已经进行过预训练的嵌入模块，输入支持样本得到特征矩阵，并将其输入到类相关自适应度量模块，进行特征拼接并得到关系分数，将相似性最大的类作为预测类别，得到最终预测结果，从而提高小样本图像分类的性能，解决小样本图像分类中基于类内共性特征的度量学习问题，对于图像的分类效果十分明显，在实践中体现出极大价值。

---

[0060] 本发明提供了一种融入类别自适应度量学习的小样本图像分类装置，包括以下模块：

- 数据预处理模块：将数据划分为训练集和测试集，确定模型训练方式；
- 网络模型构建模块：构建融入类别自适应度量学习的小样本图像分类模型；
- 模型参数训练模块：利用基类数据对模型进行训练，求解模型参数；
- 模型性能测试模块：对新类任务进行预测，测评模型性能。

[0062] 数据预处理模块执行以下步骤：

- 将数据分为训练集Dtrain和新类数据Dtest；
- 对于C-way K-shot分类任务，从Dtrain中随机选出C个类别，每个类别中随机选出K个支持样本Si和M-K个查询样本Qi。

[0066] 网络模型构建模块由嵌入模块fθ和类相关自适应度量模块组成：

- 嵌入模块fθ包含四个卷积块，用于提取样本特征；
- 类相关自适应度量模块学习特定类别的样本特征之间的度量。

[0070] 模型参数训练模块执行以下步骤：

- 对嵌入模块fθ进行预训练；
- 微调关系模块，提高模型泛化能力；
- 利用均方误差损失函数(MSE)计算损失。

[0080] 模型性能测试模块执行以下步骤：

- 将查询样本输入嵌入模块fθ；
- 输出特征矩阵输入类相关自适应度量模块，得到相似性关系；
- 将相似性最大的类作为预测类别。

[0085] 本发明的小样本图像分类方法包括以下步骤：

- 数据预处理；
- 构建融入类别自适应度量学习的小样本图像分类模型；
- 模型训练；
- 模型性能测试。

本发明通过构建每个类别的度量模块，提高小样本图像分类性能。

---