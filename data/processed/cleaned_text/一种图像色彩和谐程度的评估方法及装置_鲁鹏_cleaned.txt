本发明提供了一种图像色彩和谐程度的评估方法及装置，包括以下步骤：

1. 通过预设的无向图建立初始条件随机场。
2. 获取多张高质量样本图像和多张低质量样本图像，将每张图像切分为多个样本图像块，并将高质量样本图像块归类至第一样本图像块集合，低质量样本图像块归类至第二样本图像块集合。
3. 从第一样本图像块集合中选取一个样本图像块并标注第一类别标签后，输入初始残差神经网络；从第二样本图像块集合中选取一个样本图像块并标注第二类别标签后，输入至初始残差神经网络，对初始残差神经网络进行训练。
4. 从第一样本图像块集合中选取两个样本图像块并标注第三类别标签后，输入至初始孪生神经网络；从第二样本图像块集合中选取两个样本图像块并标注第四类别标签后，输入至初始孪生神经网络，对初始孪生神经网络进行训练。
5. 利用训练后的残差神经网络确定初始条件随机场的关联势函数，利用训练后的孪生神经网络确定交互势函数。
6. 根据关联势函数和交互势函数确定条件随机场模型。
7. 当获取到待评估图像时，将待评估图像切分为多个图像块并输入至条件随机场模型，计算得到待评估图像的色彩和谐评估值。

本发明实现了自动对图像的色彩和谐程度进行评估。

为了更清晰地说明本申请实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本申请的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。

图1为本发明实施例提供的图像色彩和谐程度的评估方法的一种流程示意图；

图2为本发明实施例中建立无向图的示意图；

图3为基于ResNet卷积神经网络所构建的初始残差神经网络的结构示意图；

图4为基于ResNet卷积神经网络所构建的初始孪生神经网络的结构示意图；

图5为本发明实施例提供的图像色彩和谐程度的评估装置的一种结构示意图；

图6为本发明实施例提供的图像色彩和谐程度的评估装置的另一种结构示意图；

图7为本发明实施例提供的电子设备的一种结构示意图。

具体实施方式

下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行描述。

现有技术中，技术人员根据经验选取一些与图像美学评价相关的图像特征描述图像美学质量。例如将光照和色彩、饱和度和色调、三分法、区域组成等多重特征引入到SVM等相关工具中进行训练，并对目标图像的美学价值进行分类评估。然而，经验性地提取图像特征来进行美学评估是一项繁琐的工作，严重依赖于技术人员对照相领域知识的理解，技术人员难以选择合适的图像美学评价的图像特征，致使图像美学评估的准确度不高。

色彩是图像的重要特征，色彩和谐程度直接影响着人们对于照片质量的感受。传统的色彩和谐模型大都来自于人工经验，不适用于颜色复杂度高的照片的色彩评估任务。利用机器方法从大量的图片中学习色彩和谐关系是一种更为有效的图像色彩和谐度计算方法。

直接评估一副图像的色彩和谐程度，由于颜色的组合空间过大，通常难以直接建立机器学习建模。但是，一副图像可以看做是图像局部区域的集合，此时，图像的和谐度可以通过这些局部图像区域的和谐程度来表示。而图像局部区域的色彩质量不仅取决于区域内颜色的和谐程度，还取决于其与邻域图像块之间的色彩和谐关系。基于上述分析，本发明提出了一种基于条件随机场的色彩和谐模型，同时考虑影响局部区域色彩和谐度的两种因素。

总体上来说，本发明提供了一种图像色彩和谐程度的评估方法、装置、电子设备及计算机可读存储介质。上述方法可以应用于可以计算处理图像的终端，例如计算机。

利用本发明实施例提供的方法，终端可以将图像划分成多个图像块确定无向图，终端根据无向图建立条件随机场，并用训练后的神经网络确定条件随机场的关联势函数和条件势函数，得到色彩和谐模型。终端根据得到的色彩模型来评估图像美学得分。终端通过表示条件随机场关联势函数的神经网络提取图像块的RGB(Red，Green，Blue，红，绿，蓝)色彩值，计算图像块的色彩和谐性，通过表示条件随机场关联势函数的神经网络提取相邻图像块的RGB(Red，Green，Blue，红，绿，蓝)色彩值，计算相邻图像块的色彩和谐性，再通过条件随机场将图像的多个图像块的色彩和谐性整合在一起，得到图像的美学评估。相比于现有技术，本发明实施例提供的方法，提取图像特征简单，利用神经网络计算准确，可以提高图像美学评估的准确性。

参见图1，图1为本发明实施例的一种图像色彩和谐程度的评估方法流程图，包括如下步骤：

S101，通过预设的无向图建立初始条件随机场。

S102，根据预设样本图像和预设训练算法，对初始神经网络进行训练。

S103，利用训练后的神经网络确定初始条件随机场的关联势函数及交互势函数。

S104，根据关联势函数和交互势函数，确定初始条件随机场对应的条件随机场模型。

S105，当获取到待评估图像时，将待评估图像切分为多个图像块并输入至条件随机场模型，计算得到待评估图像的色彩和谐评估值。

本发明实施例提供的一种图像色彩和谐程度的评估装置，建立初始条件随机场，对初始神经网络进行训练，利用训练后的神经网络确定初始条件随机场的关联势函数及交互势函数，进而根据关联势函数和交互势函数，确定初始条件随机场对应的条件随机场模型，即色彩和谐模型，当需要对图像的和谐程度进行评估时，只需将该图像切分后输入至色彩和谐模型，无需人工评估即可计算得到对应的色彩和谐评估值，从而实现自动对图像的色彩和谐程度进行评估。

本发明实施例还提供了一种电子设备，包括处理器、通信接口、存储器和通信总线，其中，处理器、通信接口、存储器通过通信总线完成相互间的通信，存储器用于存放计算机程序；处理器用于执行存储器上所存放的程序时，实现如下步骤：通过预设的无向图建立初始条件随机场；根据预设样本图像和预设训练算法，对初始神经网络进行训练，预设样本图像包括高质量预设样本图像和低质量预设样本图像；利用训练后的神经网络确定初始条件随机场的关联势函数及交互势函数；根据关联势函数和交互势函数，确定初始条件随机场对应的条件随机场模型；当获取到待评估图像时，将待评估图像切分为多个图像块并输入至条件随机场模型，计算得到待评估图像的色彩和谐评估值。

本发明实施例提供一种电子设备，通过建立初始条件随机场并训练初始神经网络，利用训练后的神经网络确定关联势函数及交互势函数，进而确定对应的条件随机场模型，即色彩和谐模型。该模型可自动评估图像的色彩和谐程度。电子设备中，通信总线可以是PCI或EISA总线，通信接口用于设备间通信，存储器包括RAM和磁盘存储器。

处理器可以是CPU、NP、DSP、ASIC、FPGA或其他可编程逻辑器件。本发明还涉及一种计算机可读存储介质，存储有执行以下步骤的计算机程序：建立初始条件随机场；对初始神经网络进行训练；确定关联势函数及交互势函数；确定条件随机场模型；对待评估图像进行色彩和谐评估。

本发明实施例的装置、电子设备及存储介质适用于图像色彩和谐程度的评估方法，并能达到相同或相似的有益效果。关系术语如“第一和第二”用于区分实体或操作，而不暗示实际关系。术语“包括”意指非排他性包含。各实施例重点说明与其他实施例的不同之处。本发明的保护范围包括在精神和原则内的任何修改、等效替换、改进等。