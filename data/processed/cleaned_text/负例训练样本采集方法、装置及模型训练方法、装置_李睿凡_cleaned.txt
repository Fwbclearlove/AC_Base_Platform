本发明实施例提供了一种负例训练样本采集方法，包括以下步骤：

1. 将多张图像输入到初始图像检索模型中，得到各图像对应的表示向量，构成样本集合。

2. 对样本集合中的表示向量进行聚类，得到多个聚类，并确定每个聚类的聚类中心。

3. 针对每个目标向量，确定其所属的第一聚类。

4. 基于第一聚类的聚类中心，确定目标向量对应的多个候选聚类的目标概率。

5. 基于目标概率，对目标向量对应的候选聚类执行多次聚类抽取操作，得到多个第二聚类。

6. 在每个第二聚类中获取一个表示向量，作为目标向量的负例训练样本。

此外，本发明还提供了基于该负例训练样本采集方法的模型训练方法，包括以下步骤：

1. 在样本集合中获取多个目标向量，并确定每个目标向量的正例训练样本。

2. 确定每个目标向量的多个负例训练样本。

3. 确定多组训练样本，每组包括一个目标向量、其正例和负例训练样本。

4. 基于训练样本对初始图像检索模型进行训练，并计数迭代次数。

5. 当迭代次数达到预设值时，判断是否满足停止条件，若满足则停止训练，否则重新确定训练样本继续训练。

本发明还提供了相应的负例训练样本采集装置和模型训练装置。

根据提供的学术论文片段，以下是清洗后的内容：

---

在本发明实施例提供的一种负例训练样本采集方法中，通过对样本集中各个表示向量的聚类，将各个表示向量按照相似度进行分类。从而可以确定每个候选聚类作为目标向量所属的第一聚类的近邻聚类的概率，也就是可以确定每个候选聚类中的表示向量作为目标向量的负例训练样本的难度水平。继而，基于该概率确定用于抽取该目标向量的负例训练样本的第二聚类，便可以兼顾到兼顾各个不同难度水平的负例训练样本。同时，由于概率较大的聚类中的表示向量为“较难”的负例训练样本，根据概率论的相关知识，显然，这些概率较大的聚类被抽取为第二聚类的可能性较高。因此，采集负例训练样本时，不但可以兼顾各个不同难度水平的负例训练样本，还可以优先采集“难”的负例训练样本。

在本发明实施例提供的一种模型训练方法中，考虑到在图像检索模型的训练过程中，模型的相关参数和权重会发生变化，导致样本集合的聚类结果发生变化，进而导致基于聚类结果确定的训练样本发生变化，因此，在图像检索模型的训练过程中，可以随着模型的相关参数和权重的变化，调整对样本集合的聚类结果，使获得的负例训练样本更具有代表性。同时，在模型训练方法中通过上述负例训练样本采集方法确定训练样本中的负例训练样本，以使得每次确定的负例训练样本时，可以在兼顾各个不同难度水平的负例训练样本的同时，优先采集“难”的负例训练样本。进而，可以提高基于获得的负例训练样本训练得到的图像检索模型的检索准确率。

---

以上内容已去除页眉、页脚、页码、重复信息和乱码，保留了核心学术内容、技术术语和数据、原有逻辑结构、公式和图表说明。

本发明提供了一种负例训练样本采集方法，通过对样本集合中各个表示向量的聚类，将各个表示向量按照相似度进行分类。可以确定每个候选聚类作为目标向量所属的第一聚类的近邻聚类的概率，即可以确定每个候选聚类中的表示向量作为目标向量的负例训练样本的难度水平。基于该概率确定用于抽取该目标向量的负例训练样本的第二聚类，可以兼顾到兼顾各个不同难度水平的负例训练样本。同时，由于概率较大的聚类中的表示向量为“较难”的负例训练样本，这些概率较大的聚类被抽取为第二聚类的可能性较高。因此，采集负例训练样本时，不但可以兼顾各个不同难度水平的负例训练样本，还可以优先采集“难”的负例训练样本。

本发明还提供了一种基于上述负例训练样本采集方法的模型训练方法。该方法包括在预设的初始图像检索模型获得的样本集合中获取多个目标向量，并确定每个目标向量所对应的一个正例训练样本；针对每个目标向量，在样本集合中确定该目标向量所对应的多个负例训练样本；确定多组训练样本，其中，每个训练样本包括一个目标向量、该目标向量所对应的一个正例训练样本和该目标向量所对应的多个负例训练样本；基于多组训练样本对预设的初始图像检索模型进行训练，并从零开始对迭代次数进行计数，作为目标次数；当目标次数达到预设数值时，判断是否满足训练停止条件；如果满足，执行停止模型训练，得到训练完成的图像检索模型；否则，执行将目标次数清零。通过该方法可以提高基于获得的负例训练样本训练得到的图像检索模型的检索准确率。

[0201] 对样本集合的多个表示向量进行聚类，得到多个聚类并确定聚类中心；

[0202] 确定每个目标向量所属的第一聚类，目标向量为多张图像中目标图像对应的表示向量；

[0203] 基于第一聚类的聚类中心，确定每个目标向量对应的多个候选聚类的目标概率，任一聚类的目标概率为该聚类作为第一聚类的近邻聚类的概率；

[0204] 基于目标概率，对每个目标向量对应的多个候选聚类执行聚类抽取操作，得到多个第二聚类；

[0205] 在每个第二聚类中获取一个表示向量，作为目标向量的负例训练样本。

[0206] 本发明提供的负例训练样本采集方法的其他实现方式与上述方法实施例相同。

[0207] 本发明通过聚类将表示向量按相似度分类，确定候选聚类的目标概率，基于此概率确定负例训练样本的第二聚类，兼顾不同难度水平的负例训练样本。

[0211] 模型训练方法包括：获取目标向量，确定正例训练样本和负例训练样本，确定多组训练样本，对初始图像检索模型进行训练，迭代计数，判断是否满足训练停止条件。

[0226] 负例训练样本采集方法包括：输入多张图像到初始图像检索模型，得到表示向量，进行聚类，确定目标向量的第一聚类和候选聚类的目标概率，执行聚类抽取操作，获取负例训练样本。

[0245] 在模型训练过程中，根据模型参数和权重的变化调整聚类结果，确保负例训练样本的代表性，提高图像检索模型的检索准确率。

[0246] 本发明中的关系术语不要求实体或操作之间存在实际关系或顺序，"包括"等术语意在涵盖非排他性的包含。

[0248] 本发明的保护范围不限于上述实施例，任何修改、替换、改进均在保护范围内。