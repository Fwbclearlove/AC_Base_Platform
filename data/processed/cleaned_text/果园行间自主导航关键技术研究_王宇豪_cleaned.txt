果园行间自主导航关键技术研究

我国水果产量自1990年至2019年居世界首位，果品产业成为农村经济的重要支柱。为提升生产效率和水果品质，农业机械装备的智能化是发展趋势。智能农业装备通过传感器感知环境信息和自身状态，在果园环境中执行任务。果园行间自主导航技术能够降低劳动强度，提高作业效率。本文围绕单目视觉导航和激光雷达导航进行研究，主要工作和创新点如下：

(1) 提出自适应半径滤波方法，动态计算滤波半径以抑制激光点云密度影响，实现多尺度噪声去除。实验结果显示，DBSCAN聚类精确率和召回率提升，计算时间为43ms。

(2) 提出基于交叉像素的可通行区域提取方法，适应性和稳定性强，能准确提取可通行区域、偏航角和横向位移。

(3) 研究基于改进的Mask R-CNN网络提取场景语义信息，分割道路与树干，通过霍夫变换计算边界方程和消失点坐标，为单目位姿估计和视觉导航提供有效参考。

(4) 建立果园行间道路几何成像模型，实现偏航角、横向偏移与道路宽度的定量计算，具有高测量精度和计算效率。

(5) 利用树行共线性和边界平行性，基于单目相机计算果树相对位置，实验结果表明定位精度高，计算时间短。

关键词：自主导航，位姿测量，相机模型，深度神经网络，自适应半径滤波

Research on Key Technologies of Autonomous Navigation Between Rows in Orchard

Abstract

Chinese fruit production has ranked first worldwide from 1990 to 2019, with the fruit industry becoming a significant pillar of the rural economy. The intelligentization of agricultural machinery is a trend to enhance production efficiency and fruit quality. Intelligent agricultural equipment uses sensors to perceive environmental information and its state for task execution in orchards. Autonomous navigation between orchard rows reduces labor intensity and improves efficiency. This paper focuses on monocular vision and lidar navigation, with main work and innovations as follows:

(1) An adaptive radius filtering method is proposed to dynamically calculate the filter radius, suppressing the impact of LiDAR point cloud density for multi-scale noise removal. Experimental results show increased DBSCAN precision and recall rates with an average calculation time of 43ms.

(2) A passable area extraction method based on intersecting pixels is proposed, demonstrating high adaptability and stability in accurately extracting passable areas, yaw angles, and lateral displacements.

(3) An improved Mask R-CNN network is used for scene semantic information extraction, segmenting roads and tree trunks, and calculating boundary equations and vanishing point coordinates using the Hough transform, providing an effective reference for monocular pose estimation and visual navigation.

(4) A geometric imaging model of orchard roads is established for quantitative calculations of yaw angle, lateral offset, and road width, with high measurement accuracy and computational efficiency.

(5) Relative fruit tree positioning is calculated using monocular camera based on tree row collinearity and boundary parallelism, showing high positioning accuracy and short calculation time.

Key words: autonomous navigation, pose measurement, camera model, deep neural network, adaptive radius filter.

---

4.2.3 密集种植场景实验与分析
4.2.4 误差来源分析
4.3 本章总结
第五章 基于单目视觉的行间自主导航方法
5.1 道路与消失点信息提取
   5.1.1 果园场景实例分割
   5.1.2 消失点和边界方程提取
   5.1.3 实验与分析
5.2 位姿估计方法
   5.2.1 道路几何成像模型
   5.2.3 偏航角与横向偏移估计
   5.2.4 实验与分析
5.3 果树定位方法
   5.3.1 果树相对位置估计
   5.3.2 实验与分析
5.5 本章总结
第六章 结论与展望
   6.1 主要结论
   6.2 研究展望

第一章 绪论
1.1 研究背景和意义
1.2 国内外研究现状及存在的问题
   1.2.1 基于激光雷达的行间自主导航技术
   1.2.2 基于视觉的行间自主导航技术
1.3 研究内容
1.4 组织结构

第二章 行间自主导航理论基础
2.1 惯性导航理论

---

捷联式惯导技术通过数字计算平台实现导航，提高了结构的可靠性和易用性。其姿态估计方法包括将加速度计和陀螺仪安装在载体上，计算载体坐标系下的角速度，并利用该信息计算姿态矩阵。加速度计和陀螺仪分别用于估计姿态角和角速度，但存在动态性能和累计误差问题。目前，基于概率滤波器的融合导航方法可在一定程度上抑制误差，但长时间工作仍存在累计误差。因此，本文研究了激光雷达导航和单目视觉导航方法。

激光雷达导航理论包括点云滤波方法和点云密度聚类方法。点云滤波方法包括统计滤波和半径滤波，用于抑制噪声点。统计滤波通过计算点到近邻的平均距离，与阈值比较判断噪声点。半径滤波通过考察点云中指定半径内的相邻点数量判断孤立点。点云密度聚类方法包括K-Means聚类和基于密度的聚类方法，用于对点云进行聚类。

单目视觉导航理论包括单目相机成像原理和目标信息提取方法。单目相机成像原理描述了三维世界坐标点到二维像平面的映射关系。目标信息提取方法包括基于特征分类器的目标检测方法和基于深度神经网络的目标检测方法。基于深度学习的实例分割模型如Mask R-CNN，可同时完成目标识别和实例分割，具有较高的精度和适应性。

综上所述，本章分析了惯性导航、激光雷达导航和单目视觉导航的理论基础，为后续研究提供了理论支持。

清洗后的内容如下：

反射的表面或者探测超出量程的目标，失落信息存在于无目标处或目标距离较远处。距离反常主要存在于目标边缘，枝叶相对密集和细小，激光点存在发射至枝叶边缘的可能，进而导致距离反常。

3.1.2 激光点云密度特性

单位矩形内的点云平均间距是衡量点云密度的重要指标，平均距离越大，点云密度越低；点云间的平均间距越小，点云密度越高。单位矩形中，点云数量为激光雷达光束与单位平面交点的数量，计算方法如公式(3-1)所示，数据点间距为面积的几何平均数，即单位面积除以点云总数的几何平均数，计算方法如公式(3-2)所示，点云密度与点云平均间距的关系呈负线性相关，计算方法如公式(3-3)所示，计算方法对应示意图如图3-1所示。

图3-1 点云平均间距计算方法示意图

1 1 2 2 2arctan 2arctan

l l m r r = ×

h w s m = × (3-2)

s c ρ=−+ (3-3)

式中 m——单位矩形的点云数量

s——点云的几何平均间距

ρ——点云密度

h——单位矩形高

w——单位矩形宽

l——激光雷达到单位矩形的距离

rh——水平方向激光雷达的角分辨率

rv——垂直方向激光雷达的角分辨率

c——点云单位间距，几何意义为单位面积内仅有单个点云时的平均间距

基于以上公式推导，研究变量rh、rv、l和点云间距s、点云密度ρ之间的关系，文中采用等边单位矩形，即h、w相同。单位矩形垂直于激光雷达中心o与y轴的延长线上，且矩形中心o'与oy共线，四者关系如图3-2、图3-3和图3-4所示。

图3-2 s-l关系曲线

图3-3 ρ-l关系曲线

0 0.5 1 1.5 激光雷达与单位矩形的距离

水平角分辨率0.1度，垂直角分辨率0.1度 水平角分辨率0.1度，垂直角分辨率0.2度 水平角分辨率0.1度，垂直角分辨率0.3度 水平角分辨率0.2度，垂直角分辨率0.2度 水平角分辨率0.2度，垂直角分辨率0.3度 水平角分辨率0.3度，垂直角分辨率0.3度

图3-4 ρ-l关系曲线(近距离区域)

由图3-2、图3-3和图3-3可知，平均间距s随距离l增加而增加，点云密度ρ随之降低，在近距离区域，点云密度ρ加速降低。其他区域的点云密度ρ与距离l呈近似线性负相关，表明此范围中的点云密度随探测距离的增加而线性减小。

经理论分析可知：理想条件下，当单位矩形与激光雷达的距离为0时，点云密度达到最大值，即ρ=1；当点云密度等于0时，单位矩形内的点云处于消失的距离l相同的条件下，激光线越密集，分辨率越高，角分辨率rv、rh数值越小，平均间距s越小，表明具有更高的点云密度ρ。由于等边矩形的h、w相同，根据公式(3-1)、公式(3-2)可知，此条件下的rv、rh具有对称性，例如，rv=0.1，rh=0.2与rv=0.2，rh=0.1两种条件下的点云密度ρ一致。为进一步研究点云密度与距离的关系，本文对公式(3-3)进行求导，以点云密度的变化率，如公式(3-4)和图3-5所示。

2 2 2 2 2 1 1 2 1 1

8 tan tan 1 8 tan t

an 1 2 2 4 2 2 4 '

4tan tan 2 2

h v h v

w w w l l l l l l l l

h r r hw r r

h r r ρ

− − − −

[ ρ(l) ] [ ρ(l) ]

图3-5 ρ’(l)-l关系曲线

经分析图3-4和图3-5可知，在激光雷达附近区域(1.5米内)的点云密度变化率ρ’(l)逐渐减小，点云密度平缓加速降低(如图3-4所示)；在1.5米以外区域，点云密度变化率ρ’(l)无明显变化，近似为常数，点云密度ρ(l)与距离l可近似为线性负相关。

综合以上分析，除激光雷达附近的点云外，其他区域的点云密度近似线性减小。激光雷达常用于较远距离点云信息的获取，点云密度非线性变化的区域集中在激光雷达附近，所占比重较低，而且本文所用激光雷达的探测范围为0.4m-28m，在此区域点云密度近似线性变化。激光雷达输出点云密度具有随目标点距离增大而减小的特性，其点云密度分布示意图如图3-7所示。

图3-7 激光雷达点云密度分布示意图

由图3-7可知，近距离区域和远距离区域的点云密度差异较大，点云密度与探测距离近似线性负相关，点云噪声密度分布同样符合以上特性，A1、A2、A3以r为半径的邻域内分别具有1、4、15个近邻，其数量差异明显，由于半径滤波参数固定，在场景中，容易出现过度去噪或噪声残留问题，实际效果并不理想。

3.2 自适应半径滤波原理

含有噪声的激光点云果园机器人工作场景可分为密集种植环境和非密集种植环境，水果种植园行间纵深较大、光线复杂多变，导致激光点云密度具有较大的差异性，噪声具有较高的随机性。

在密集种植场景中，激光点云呈连续立面状；在非密集种植场景中，激光数据表现为若干点云簇。由于不同种植模式中的点云簇形状和大小均存在差异性，为更有效地抑制噪声，需要根据种植模式调整滤波器参数。为使滤波器参数对种植模式有更高的适应性，也为避免在运行过程中整定方法参数，本文构建了基于卷积神经网络的种植模式判定器，并支持预置滤波器参数，实现了根据点云数据特征自动选取相应的去噪参数。

为使滤波器参数与点云密度匹配，适应密度差异大且随机性强[37-38]的激光点云噪声，提出动态半径滤波器，该方法的滤波半径可根据点云密度动态调整，适应不同密度的点云噪声，从而实现对多尺度激光点云噪声的有效抑制。

本文提出的自适应半径滤波器由点云图像转换器、种植模式判定器和动态半径滤波器组成。由于激光点云通常呈无序排列，其处理速度相对较慢，而图像数据通常为多维矩阵，处理方法更加多样且高效，更适合用于场景分类。滤波器结构如图3-8所示。

图3-8 自适应半径滤波器结构图

由图3-8所示，自适应半径滤波器首先利用点云图像转换器将从激光雷达中获取原始点云数据转换为二值图像。其次，场景判定层根据二值图像判断当前种植模式，并将场景类别信息传递至下一层。最后，点云去噪层将根据点云密度去噪，当处理完所有信息点，输出去噪结果。自适应半径滤波器周期运行，从而使该模型具有对种植模式变化的场景具有良好的适应性。

3.2.1 种植模式判定器

果园机器人运行过程中，数据采集角度和位置均具有较大的不确定性，且各果园的株距行距不尽相同，导致激光雷达可探测的范围不同。机器人在上述条件作业时，激光点云及其二值图的特征变化明显，难以用单一特征判别种植模式。

目前，大部分传统的特征提取方法提取的特征相对较浅，如HOG特征、SIFT特征、颜色特征、局部二值特征等，基于传统特征的分类器适用于某些特定场景。在复杂多变的场景中，表现并不尽如人意，难以满足种植模式的分类需求。

深度卷积神经网络具有模型层次深、特征表达能力强的特点，能自适应地从大规模数据集中学习当前任务所需要的特征表达，广泛应用于图像分类问题。因此，本文采用深度卷积神经网络作为种植模式判别器。卷积神经网络以转换后的二值图像为输入，判断并输出其种植模式。

由于该方法应用于实时性较高的场景，所以，在轻量化模型MobileNetV2[39]的基础上，本文重新调整并精简了瓶颈层(Bottleneck)结构和卷积核数量，网络结构如图3-9所示。

图3-9 网络模型示意图

图3-9中，Conv3BN为3×3卷积正则化层，Conv1BN为1×1卷积正则化层，DWConv3BN为3×3深度可分离卷积正则化层，深度可分离卷积能显著降低参数量和运算量，在轻量化网络中广泛使用[40]。首先，二值图经过卷积正则化层提取3张112×112特征图，之后经过瓶颈层和瓶颈残差层[39]提取更高维特征。为使网络更加高效，在网络中主要使用深度可分离卷积提取特征。此外，在网络中加入残差模块，此方法可有效抑制梯度消失和梯度爆炸问题。在网络末端，将64张7×7特征图进行全局池化，转换为特征向量，由于共有密集种植和非密集种植两个类别，因此，经全连接层变换为含有两个元素的一维向量。

本文在训练阶段利用Softmax分类器将预测类别与标签类别比较得到其交叉熵损失，进而使用Adam算法[41](Adaptive moment estimation algorithm，Adam)优化损失函数使其收敛。在推理阶段，神经网络输出当前图像所属标签，即当前种植模式，读取预置的去噪参数后，将两类信息传递至动态半径滤波算法，从而有针对性地抑制不同种植模式下的点云噪声。

3.2.2 动态半径滤波

半径滤波方法的效果与选取的半径参数相关，而半径参数与区域点云密度相关。若探测范围内点云密度相对均匀，则根据点云密度可选取适当的半径参数；若点云密度差异较大，则应根据点云密度动态改变去噪操作的半径。

降低点云密度变化的影响是提高去噪准确性的关键方法之一。点云距离激光雷达越远，其密度越稀疏，滤波半径应增大。本文根据目标点到原点的欧式距离设计该点的滤波半径，从而有效地避免了密度对滤波过程的影响，为降低算法时间和空间复杂度，将滤波半径与探测距离视作线性相关，如公式(3-7)所示。

i i r K d = × (3-7)

2 2 2 i i i i d y x z = + + (3-8)

式中 ri——滤波半径

di——目标点与原点的欧式距离，本文中激光雷达所在位置为原点

K——滤波半径相关系数

xi,yi,zi——目标点的欧式坐标

动态半径滤波的具体方法如下：

①根据场景类别初始化滤波参数：滤波半径相关系数K和近邻数量N，其中，K为目标点欧式距离的缩小比例，K值越大，则滤波半径越大，K值越小，则滤波随之减小；N为近邻数量，当邻域内的点云数目小于N时，删除该点；反之，则保留数据点。

②依据公式(3-7)、公式(3-8)计算某目标点去噪参数：欧式距离di和滤波半径ri。

③统计其滤波半径ri内的近邻点ni，若ni小于近邻数量N，则该点为离群点，删除该点；否则予以保留。当按上述步骤遍历所有目标点后，完成当前数据帧处理。

本文提出的噪声去除方法的伪代码3-1如下：

伪代码3-1 自是半径滤波伪代码

Algorithm 自适应半径滤波方法 Input: 原始点云 Output: 去噪后的点云

while 接收到完整点云数据帧 do

转换原始点云为二值图；场景类别 = 改进MobileNetV2(二值图)；if 场景类别 == “密集种植” then

动态半径滤波器(K1,N1,原始点云)；else

动态半径滤波器(K2,N2,原始点云)；End function 动态半径滤波器(K,N,原始点云)

for i = 1 to 点云数量 do

2 2 2 i i i i d y x z = + + (3-8)

ri = K di if 以pi为中心,ri为半径的邻域内的点云数量小于N then

删除该点；else

保留该点；end end

3.3 实验与分析

为保证数据集能够较好地反映自然条件下树林的真实特点，分别在苹果种植园、白杨树林和旱柳树林进行实验，点云采集设备为北醒光子CE30-D固态面阵激光雷达，其固有参数为探测范围0.4m-28m，视场角60°×4°，分辨率320×20。

此类场景中，激光雷达主要受到两类噪声的干扰，一是天空、树行尽头等无目标处产生的失落信息，二是树干、树枝等目标边缘产生的逸出值。实验场景及其噪声来源具有较强的代表性，且包含的信息复杂程度与农业自动导航机器人的一般工作环境相似。

同时，为验证算法有效性，将本文去噪方法与点云库PCL中的统计滤波、半径滤波进行对比测试，实验平台为Intel(R) Core(TM) i7-6850K CPU@3.60GHz，NVIDIA 1080Ti×4 GPU，32GB RAM，500GB SSD。

3.3.1 种植模式判定器性能与分析

本文共收集1083张点云数据，其中，477来自采用密集矮化种植的苹果园，在胸高位置，密集种植的植株间不存在明显间隙；285张来自非密集种植的白杨树林，321张来自非密集种植的旱柳树林，在此种植条件下，植株间在胸高位置存在明显间隙。

训练神经网络时，先将点云数据转换成俯视视角的二值图像，点云转二值图平均耗时为每张0.312 ms。数据集的60%作为训练集，20%作为验证集，20%作为测试集。配置网络超参数如下：批处理大小为128张，学习率为0.05，Adam优化器，同时，模型训练过程中，使用随机旋转的方法增强数据。采用边训练边评估的方式，共训练1000周期，过程的平均损失值、训练精度和验证集精度如图3-10、图3-11、图3-12所示。

0 200 400 600 800 1000 0.0

图3-10 训练过程的损失值

0 200 400 600 800 1000 0.7

训练集精确度

图3-11 训练集精确度

0 200 400 600 800 1000 0.0

验证集精确率

图3-12 验证集精度

由于训练集和验证集存在差异性，且训练初期的模型参数变化明显，因此，验证集精度呈波动上升趋势，如图3-12所示。本文为抑制模型过拟合现象，在训练时随机旋转数据集角度，增加了训练数据的复杂性和多样性，加剧了训练集和验证集的差异，导致验证集精度曲线波动更加明显。随着训练周期的增加，模型参数逐渐收敛，分类能力趋于稳定。

训练至702周期时，分类器在训练集的精确率为0.99，验证集的精确率为0.98，综合效果较好，仅使用CPU的条件下，推理速度平均为每帧7.51ms；如果使用GPU，推理速度为每帧7.04ms。测试结果如图3-13所示。

(a)密集种植 (b)非密集种植

图3-13 模型测试结果

由图3-13可知，该模型可准确分类不同拍摄角度和位置的场景类别，数据中包含失落信息、逸出值等类型噪声，模型仍可准确分类，且计算时间较低，具有强的鲁棒性和高效性。

3.3.2 去噪结果分析

点云去噪不仅应准确去除远处、近处和物体边缘的噪声，而且目标点云簇的细节和特征应被充分保留，为聚类、识别和融合等操作奠定基础。由于点云去噪为不可逆操作，因此本文在整定去噪参数时，以保留充足的信息量为原则，兼顾去噪效果和目标细节。经过实验分析，三种方法去噪的参数如表3-1所示：

表3-1 去噪参数

滤波方法 密集种植场景 非密集种植场景

半径滤波 近邻数量 6 30 滤波半径 0.3 0.8

统计滤波 近邻数量 30 30 标准差倍数 2 0.5

本文方法 近邻数量 11 30 滤波半径相关系数 0.072 0.066

1.苹果果园实验结果

实验地点为北京市昌平区苹果果园，该果园采用矮化密植的种植模式，株行距为1×3米，如图3-14所示。

图3-14 苹果果园实验场景

在图3-14所示的场景中，点云噪声主要来自两个方面：一是枝叶边缘带来的逸出值，如图3-15(a)的虚线框所示；二是部分激光束穿过枝叶间隙到达无目标处，带来失落信息，表现为近距离密集噪声，如图3-15(a)的实线框所示。去噪方法应有效抑制目标边缘的逸出值和近距离密集噪声，且保留丰富的点云信息。

图3-15 苹果果园实验结果

图3-15(b)为统计滤波结果，近距离区域存在大量密集噪声；在远

清洗后的内容如下：

抑制离群噪声和拖点，但近距离区域内存在大量密集噪声，半径滤波在远距离区域目标数量和细节相对更少。图3-19(d)为本文提出的自适应半径滤波实验结果，稀疏离群点、密集噪声和目标周围的拖点被有效抑制，目标数量和细节损失更少。

4.计算效率分析

综合比较三种去噪方法，由于半径滤波和统计滤波参数固定，容易出现细节损失和噪声残留的问题，本文方法根据点云密度动态调整去噪参数，可有效抑制不同点云密度中的噪声，且目标特征保留相对完整。为比较方法计算效率，本文统计了三种滤波器的去噪时间，如表3-2所示。

表3-2 去噪计算时间分析

统计滤波 半径滤波 本文方法

去噪耗时/ms

苹果果园 36.1 35.4 43.1 白杨树林 52.1 51.9 45.6 旱柳树林 48.5 47.4 40.8 平均值 45.6 44.9 43.2

由表3-2可知，与半径滤波和统计滤波相比，本文方法的去噪时间(已包含神经网络分类时间)并未明显增加。一方面，由于以上算法均基于领域分析，去除邻域中点云的数量越多，算法迭代次数越少，耗时越短，本文方法的噪声去除率更高，因此，去噪耗时更短。另一方面，本文优化了神经网络模型，使网络模型更加符合使用条件，通过合理地裁剪卷积层、广泛使用深度可分离卷积、减少池化层等方式，不仅取得了较高的算法效率，而且保证了网络的分类精度。

第三章 基于自适应半径滤波的激光点云去噪方法

5.密度聚类相关分析

本文聚类精确率、聚类召回率和F1分数四个维度评价算法性能。本文将原始点云、去噪后的点云进行DBSCAN聚类，聚类结果包含3类信息：噪声点云簇、目标点云簇和未被聚类点云。本文把聚类结果的精确率(Precision)、召回率(Recall)和F1分数的计算方法为：

TPA=(3-9)

TRG=(3-10)

1 2 PRFPR×=×+ (3-11)

式中P——聚类精确率

R——聚类召回率

F1——F1分数

T——聚类结果中，目标点云簇数量

A——聚类结果中，目标点云簇和噪声点云簇数量之和

G——实际目标点云簇数量

点云的噪声数量直接影响聚类或识别的精度，经过去噪的点云有利于提升聚类的精确率和召回率。首先，对原始数据依次用统计滤波、半径滤波和本文提出自适应半径滤波进行去噪，并统计去噪时间，本文方法的去噪时间由三部分组成：点云转换图像、神经网络推理和自适应半径滤波；其次，针对白杨树林和旱柳树林原始数据和滤波结果，依次进行DBSCAN聚类，计算其精确率、召回率和F1分数。由于苹果种植园采用密集种植方法，点云呈连续的立面状，不适合做聚类分析。白杨树林和旱柳树林的聚类真值如图3-20(b)和图3-21(b)所示。

(a)采集场景 (b)聚类真值

图3-20 白杨树林采集场景及聚类结果

第三章 基于自适应半径滤波的激光点云去噪方法

(a)采集场景 (b)聚类真值

图3-21 旱柳树林采集场景及聚类结果

图3-20(b)与图3-21(b)中的矩形框中为目标点云簇，白杨树林和旱柳树林的聚类真值分别为20和22，其余部分为点云噪声或信息量很少的点云。由图3-17、图3-19可知，DBSCAN算法能够在含有较多噪声的激光点云数据中，较准确地完成聚类分割，对明显的离群噪声有较强的抑制效果。但由于果园场景较大且复杂多变，点云数据包含较多的失落信息和逸出值，基于原始数据的聚类结果精确度较低，而基于去噪点云的聚类效果有较明显的提升。结合图3-17与图3-19中的聚类信息，计算精确率、召回率和F1分数，结果如表3-3所示。

表3-3 DBSCAN聚类结果

去噪方法 原始数据 统计滤波 半径滤波 本文方法

白杨树林 0.500 0.875 0.933 0.944

旱柳树林 0.579 0.938 0.923 0.941

平均值 0.539 0.906 0.928 0.943

白杨树林 0.400 0.700 0.700 0.850

旱柳树林 0.500 0.682 0.545 0.727

平均值 0.450 0.691 0.623 0.789

白杨树林 0.444 0.778 0.800 0.895

旱柳树林 0.537 0.789 0.686 0.821

平均值 0.491 0.784 0.743 0.858

根据表3-3可知，聚类原始数据的平均F1分数为0.491，而统计滤波、半径滤波和自适应半径滤波的平均F1分数分别为0.784、0.743、0.858，相比提升29.3%，25.2%、36.7%。经本文提出的自适应半径滤波方法去噪后，DBSCAN聚类的平均精确率和平均召回率的提升40.4%和33.9%，高于统计滤波和半径滤波，也表明该方法的有效性。综上所述，基于自适应半径滤波方法和DBSCAN聚类方法，能够实现准确、稳定地聚类分割激光点云数据，为点云后续处理提供更可靠的数据。

6.综合分析

在诸如苹果果园、白杨树林和旱柳树林等大场景中，点云密度相差较大，本文中的数据点间平均距离相差约70倍，而半径滤波、统计滤波的参数固定，不能根据点云密度动态调整，去噪效果容易受到点云密度、数据点间距的影响，实际效果并不理想。

经分析，在密集种植和非密集种植场景中，激光点云的形态特点差异较大，通常需要采用多组去噪参数，本文通过提前预置参数并使用神经网络分类器的方式，有效地提升了方法的适应性。

本文提出动态半径滤波器，利用点云密度与探测距离近似负相关的特性，根据目标点到原点的欧式距离，有针对性地设计该点的滤波半径，从而有效地避免了点云密度差异对去噪的影响，实现有效抑制噪声的同时，保留更加丰富的场景信息。

该方法共有近邻数量和滤波半径相关系数两个参数：近邻数量相同时，增大滤波半径相关系数，噪声去除能力有所减弱；在滤波半径相关系数一定时，适当增大最小近邻数可提升滤波效果。经实验：在密集种植场景，点云呈连续里面状，选择较多的近邻数量和较大的滤波半径相关系数有利于保持点云特征并提高去噪效果；而在非密集种植场景，激光数据表现为若干点云簇，近邻数量较多且滤波半径相关系数较大时，目标信息损失较少，噪声抑制效果更加显著。

综上所述，本文提出的自适应半径滤波不仅能有效去除稀疏离群噪声，而且对密集噪声、目标周围的噪声同样有较明显的抑制效果。此外，与半径滤波和统计滤波相比，耗时基本一致，具有较高的实时性，可适用于密集种植、非密集种植场景。自适应半径滤波保留了更加丰富的目标信息，较明显地提升了聚类精确率和召回率，有利于提升后续点云处理的效果。

3.4 本章总结

本章主要研究内容由两部分组成：一是激光雷达噪声来源及密度特性，二是激光点云去噪方法。在果园条件中，激光雷达噪声主要来源无目标处的失落信息和微小目标处的逸出值，激光点云密度差异较大，在工作范围内，点云密度对探测距离的导数值约为常数，表明点云密度呈线性减小。基于点云密度特性，提出自适应半径滤波方法，该方法由种植模式判定器和动态半径滤波组成，判定器用于识别当前种植模式并确定去噪参数，动态半径滤波器基于数据点的欧式距离设计滤波半径，实现与点云密度相适应。

实验结果表明：本文提出的自适应半径滤波方法可明显抑制多尺度噪声，对密集噪声和稀疏离群点均可有效去除，基于优化设计的卷积神经网络和较高的噪声去除率，该方法的去噪时间未明显增加，具有较高的效率，为后续点云处理提供可靠的点云数据。

第四章 基于激光雷达的行间自主导航方法

第四章 基于激光雷达的行间自主导航方法

从激光雷达获取的数据通常为无序点云，即由数据点位置构成的列表，与矩阵排列的数据相比，此类数据处理方法相对复杂且计算量大，而自主导航技术需要算法具有高效性、稳定性和鲁棒性，农业机械装备自主运行需要感知周围目标类别和方位，因此，本文将点云转化为距离二值图后，进行形态学处理提取感兴趣区域，提出交叉像素的可通行区域提取与位姿估计方法，在密集种植和非密集种植条件下，具有良好的鲁棒性和稳定性。

4.1 算法原理及步骤

准确提取农业机械装备的可通行区域并估计其位姿是实现自主导航的关键技术，果园场景中，可通行区域一般由左右两行植株构成的空间组成，左右两行植株在激光雷达数据中表现为高密度、大数量的点云簇，而其他区域中的点云密度和数量均较低，激光雷达数据通常为无序点云，且处理三维数据的时间和难度均大于二值图。基于以上分析，本文提出基于交叉像素的激光雷达导航方法，其流程如图4-1所示。

连通域分析 椭圆离心率分析

直线簇与ROI交叉像素数量

图4-1 基于激光雷达的导航方法流程图

由图4-1可知，本文方法由两部分构成：由数据转化、图像预处理、感兴趣区域提取等方法构成图像处理模块，由直线簇生成、交叉像素统计、位姿估计等方法构成导航信息提取模块，具体流程与原理如下：

1.参数初始化

由于激光雷达探测范围和导航精度需求不尽相同，本文通过细腻度参数调整二值图分辨率。细腻度RW、RH越高，二值图尺寸W、H越大，点云转换至二值图的量化误差越低，有利于提升导航信息的准确性，但也增加了数据计算量。图像尺寸由公式(4-1)和公式(4-2)确定。

LWR=(4-1)

LHR=(4-2)

式中LW——激光雷达探测宽度

LH——激光雷达探测长度

RW——宽度细腻度，物理意义为单个像素代表距离值

RH——高度细腻度，物理意义为单个像素代表距离值

2.转换点云为二值图

为最大程度地保留信息，本文二值图包含距离信息，细腻度参数为单颗像素大小，以原点为基准，可进一步确定每颗像素对应的距离和位置。根据初始化中的图像尺寸生成矩阵I(1)，遍历所有点云数据pi(xi,yi,zi)，i=1,2,...,n，根据信息点坐标判断所属像素，根据公式(4-3)转换为二值图，并对图像I(1)依次采用孔洞填充、腐蚀、膨胀处理方法完成离群点去除与预处理。

;1yi/xiRWRH=I(4-3)

3.感兴趣区域提取

针对非密集种植场景的二值图数据，树干区域呈椭圆状，可根据其形态特点确定树干感兴趣区域。本文分析了图像连通域并标记每个独立区域，计算每个区域的离心率ξ与面积σ。若同时满足离心率阈值和面积阈值，则标记为感兴趣区域，生成对应图像I(2)，通过计算I(2)中感兴趣区域质心像素坐标可进一步估计相应树干的位置。

4.计算交叉像素

根据搜索角度和横向偏移确定斜率集合K={k1,k2,...,kp}与截距集合C={c1,c2,...,cq}，并计算直线矩阵Di,j，该矩阵由为横轴向量a和纵轴向量b组成，相应计算方法如公式(4-4)所示。创建用于存放直线像素点的图像矩阵I(3)，统计I(2)、I(3)交叉像素数量，即I(2)、I(3)矩阵点积运算后所有元素的和，计算方法如公式(4-5)所示。

[[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[ ]] [[

第五章 基于单目视觉的行间自主导航方法

与城市道路条件相比，农业果园存在密集的遮挡现象，通常也不具备可用于导航的地图，因此，自主导航逐渐成为果园机器人自主运行的关键技术。本文提出单目视觉的位姿估计和果树定位方法，方法流程如下：首先，基于Mask R-CNN深度神经网络提取道路和果树掩码；其次，根据掩码信息进一步提取消失点坐标和道路边界方程；最后，基于建立的道路成像几何模型，估计当前的位置和姿态，并计算果树的相对位置。此外，本文基于三次B样条曲线，选取起始点、消失点和中心关键点拟合导航基准线。

5.1 道路与消失点信息提取

深度神经网络具有强大的特征拟合和学习能力，可在较复杂的场景中完成目标检测、图像分割等任务。本文采用Mask R-CNN深度神经网络模型完成实例分割任务。其次，基于霍夫变换和角度阈值计算左右边界方程，联合边界方程所得的交点坐标为道路消失点。

5.2 位姿估计方法

本文利用果园边界的平行性，建立道路几何成像模型，可通过消失点坐标与边界线方程实现偏航角、横向偏移与果树位置的定量计算。首先，求解相机像平面方程；其次，计算边界线在像平面中的映射方程；最后，分析方程斜率和消失点表达式，逆解航向信息和横向位移。

第五章 基于单目视觉的行间自主导航方法

5.2.1 位姿估计方法

首先，根据边界关键点与焦点构成的直线参数方程，联立像平面方程与直线方程，解得交点坐标。然后，将交点的世界坐标转换至图像坐标系，计算其在向量上的投影。接着，确定直线在图像坐标系内的斜率、截距和方程。最后，根据透视投影原理，利用消失点坐标估计偏航角，再由像平面中的边界线方程估计横向偏移。

5.2.2 偏航角与横向偏移估计

首先，计算消失点坐标。然后，推导偏航角计算方法。再次，计算与边界S1和S2的距离。最后，计算道路宽度和横向偏移。

5.2.3 实验与分析

实验结果表明，偏航角平均误差为2.91%，横向偏移平均误差为4.82%，道路宽度平均误差为4.89%，精度可满足农业装备导航需求。

5.3 果树定位方法

5.3.1 果树相对位置估计

根据边界线像素-基本坐标系的相互映射关系，利用树干的像素坐标估计其相对位置。

5.3.2 实验与分析

实验结果表明，横向位置平均误差为3.80%，纵向位置平均误差为2.65%，株距测量误差小于10%，具有较高的准确性和稳定性。

5.4 本章总结

本章研究了基于单目视觉的位姿估计与果树定位方法，实验结果表明该方法具有较高的准确性和稳定性。

第八部分内容：

与可通行区域的识别和像素级分割密切相关。在不同拍摄位置与角度下，所提方法能稳定准确地计算消失点与边界线方程，具有高鲁棒性和适应性。对于激光雷达导航方法，提出的自适应半径滤波方法和基于深度神经网络的判定器，以及动态半径滤波，有效实现了多尺度噪声抑制。基于交叉像素的导航方法，通过图像形态学处理和直线簇交叉像素数量，实现了可通行区域的提取与位姿估计。单目视觉导航方法中，基于Mask R-CNN的场景语义信息提取方法，可准确提取不同位姿条件的消失点与道路边界。基于道路几何成像模型的位姿估算方法，利用单目相机完成偏航角估计、横向偏移计算与果树定位。实验结果表明，所提方法具有较高的实用性、稳定性和准确性。

第六章 结论与展望

6.1 主要结论

本文研究了基于激光雷达和单目视觉的导航方法。激光雷达导航方法在去噪和可通行区域提取方面表现出较强能力，而单目视觉导航方法在场景语义信息提取和位姿估算方面准确度高。

6.2 研究展望

未来的研究将聚焦于果园地图建立、场景语义信息挖掘和高精度位姿估计方法的融合。这些研究将为自主导航技术和农业装备智能化提供更坚实的理论基础。

[参考文献列表省略]

在学期间的研究成果

一、发表论文

1. 毕松, 王宇豪. 基于自适应半径滤波的激光点云去噪方法[J]. 农业机械学报, 2021.02
2. 毕松, 王宇豪. 果园机器人行间位姿估计与果树目标定位方法[J]. 农业机械学报, 2021.05

[个人感言与致谢省略]

---

值此临近毕业之际，对所受帮助和支持表达深深的感激！

---