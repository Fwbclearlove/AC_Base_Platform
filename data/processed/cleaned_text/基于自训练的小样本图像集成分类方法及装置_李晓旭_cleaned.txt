本发明公开了一种基于自训练的小样本图像集成分类方法及装置，通过迁移基类数据的卷积特征提取，使用查询样本进行基分类器的自训练，不断地将伪标签集加到支持集扩充支持集，并运用到下一次基分类器自训练中，提高了基分类器自训练结果的可靠性。自训练过程中产生的基分类器，不断通过模型平均得到集成分类器，经过多次迭代自训练和分类器集成过程，得到最终的集成分类器，通过构建损失函数，使得基分类器在查询样本上有确定的、不同的预测，实现基分类器的不同，解决现有小样本分类方法中，基于特征迁移和查询样本自训练的小样本图像集成分类中基学习器的多样性问题，对于提升图像的分类效果非常显著，具有很高的使用价值。

---

[0059] 本研究中，我们采用Baseline++网络结构构建基分类器，并提出了一种基于查询样本自训练和模型平均的集成分类方法。如图2所示。

[0060] 基分类器主要基于Baseline++网络结构，也可以采用其他网络结构如baseline。特征提取网络模块使用在基类数据上预训练得到的模型。对于新类数据，我们抽取三个数据集：有标签的支持集、无标签的支持集和查询集。

[0061] 我们优化基分类器和集成分类器，具体步骤如下：使用Baseline++网络结构，在支持集上训练得到m个基分类器，建立特征提取模块、关系网络模块和基分类器模块。特征提取模块基于卷积特征提取支持集特征，关系网络模块基于特征提取模块输出的特征和类权重向量间的余弦距离进行预测。每次任务抽取三个数据集进行以下步骤：

[0062] S21，在支持集上训练得到基分类器0，并将其赋给集成分类器0；
[0063] S22，使用基分类器0对查询集进行预测，生成伪标签预测集1，将其加入支持集训练得到基分类器1；
[0064] S23，通过模型平均集成集成分类器0和基分类器1，得到集成分类器1；
[0065] S24，迭代执行S21-S23，得到最终的集成分类器。

[0066] S25，模型结构类似于迭代模型，每次更新分类器和集成分类器以及伪标签预测集，分类器由有标签的支持集Sc和无标签的支持集U更新。

[0067] 特征提取模块和关系网络模块采用最大似然估计公式的变形进行优化。

[0076] S3、使用测试集数据对模型进行训练，优化模型参数；
[0077] 具体地，使用测试集Dtest，步骤S3包括：
[0078] S31，为每个任务抽取三个数据集；
[0079] S32，通过有标签支持集和无标签支持集U*进一步微调分类器；
[0083] S33，更新集成分类器参数；
[0086] S34，更新查询集标签。

[0089] S4、通过新类数据上所有任务中查询集标签的预测值和真实值评估模型性能。

[0090] 本发明还提供了一种基于自训练的小样本图像集成分类装置，包括以下模块：
[0091] 预训练模块；
[0092] 自训练模块；
[0093] 集成分类模块。

[0095] 本发明的装置融合了查询样本自训练和模型平均，解决了基分类器多样性问题，显著提升了图像分类效果。

---

注：已去除页眉、页脚、页码、重复信息、乱码、PDF解析错误、多余符号和格式问题，保留了核心学术内容、技术术语、数据、逻辑结构、公式和图表说明。