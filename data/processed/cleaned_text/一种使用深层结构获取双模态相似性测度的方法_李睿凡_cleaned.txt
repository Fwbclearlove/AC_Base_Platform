本发明提出了一种使用深层结构获取双模态相似性测度的方法，包括以下步骤：

1. 使用经典特征提取方法获取第一模态的低级表达P1和第二模态的低级表达T1。

2. 通过堆叠的两层受限波尔兹曼机，将第一模态的低级表达P1转换为中级表达P3，将第二模态的低级表达T1转换为中级表达T3。

3. 使用自动编码器对第一模态的中级表达P3和第二模态的中级表达T3进行编码，得到第一模态的高级表达P4和第二模态的高级表达T4。

4. 计算P4和T4的相似性测度C，公式为C(P3,T3;Wf,Wg)=||f(P3;Wf)-g(T3;Wg)||1，其中||·||1为L1范数，f(P3;Wf)=P4，g(T3;Wg)=T4，Wf和Wg分别为第一模态和第二模态的自动编码器的参数。

5. 通过训练算法优化Wf和Wg，使双模态数据的相似性测度C最小。

本发明通过深度学习框架，实现了双模态数据相似性的计算，适用于多模态数据挖掘和检索等领域。

---

[0062] 两个子网络分别记为 f(P3;Wf) 和 g(T3;Wg)，其中 f(·) 表示第一模态中级表达 P3 到 P4 的变换法则，即 P4 = f(P3;Wf)。第三组件第一模态的网络结构与第二组件的 BB-RBM 神经网络结构相同。g(·) 表示第二模态中级表达 T3 到 T4 的变换法则，即 T4 = g(T3;Wg)。P4 与 T4 维数相同，均为二元表示。

[0063] 编码层对 P4 与 T4 进行相似性测度计算：

[0064] C(P4,T4) = ||P4 - T4||1 （5）

[0065] 相似性测度公式可表示为：

[0066] C(P3,T3;Wf,Wg) = ||f(P3;Wf) - g(T3;Wg)||1 （6）

[0067] 其中 ||·||1 为 L1 范数。

[0068] 相似性测度 C 描述两个模态描述同一对象时的匹配程度。

[0069] Wf 与 Wg 是经过训练算法计算得到的配置参数，在双模态数据相似性测度计算前预先配置。

[0070] 本发明提出损失函数：

[0071] L(P3,T3,I;θ) = α(LI(P3;θ) + LT(T3;θ)) + (1-α)LC(P3,T3,I;θ) （7）

[0072] 其中，

[0073]

[0074]

[0075] LC(P3,T3,I;θ) = IC^2 + (1-I)exp(-λC) （10）

[0076] 参数 λ 由 C(P3,T3;Wf,Wg) 在整个训练集上的上界确定。参数 α 用于平衡重构损失和兼容性损失。

[0077] Wf 与 Wg 使损失函数最小。

[0078] 自动编码器的学习使用标准后传算法。两个子网在编码层通过相似性测度耦合，得到对应的编码 T4 与 P4。

---