基于语言引导的指称表达理解推理网络系统及推理方法

本发明提供一种基于语言引导的指称表达理解推理网络系统及推理方法，包括：文本特征提取器、图像特征提取器、文本特征扩展器(TFE)、跨模态对齐模块(TCA)和跨模态融合模块(TCF)。通过语言引导推理网络模型(LGR-NET)，以充分利用指称表达式的指导；设置预测标记来捕捉跨模态特征，为了充分利用文本特征，通过文本特征扩展模块(TFE)从三个方面对其进行了扩展，文本生成的坐标嵌入有助于预测词元捕获关键的视觉特征；文本特征用于交替的跨模态推理；新颖的跨模态损失增强了跨模态对齐；如此文本特征从多个角度充分的引导了模型整体的跨模态推理流程，充分利用了文本中的线索，大大提高了模型性能。

基于语言引导的指称表达理解推理网络系统的推理方法，包括如下步骤：

步骤一、多模态特征提取；采用Swin Transformer作为图像特征提取器，输入一张RGB图片，通过图像块分割模块得到初始图像特征图，通过四个降采样阶段分别生成四个特征图，使用卷积神经网络统一四个特征图的通道，最终得到图像特征。采用BERT作为文本特征提取器，在经过词表映射后的文本向量前后分别添加了[CLS]和[SEP]词元，设置最大句子长度，经过BERT的特征提取，得到文本特征。在提取完图文特征后，分别使用两个全连接神经网络(FFN)将图文特征投射到同一个特征空间，最终得到映射图像特征和映射文本特征用于后续的模块输入。

步骤二、文本特征扩展；为了充分利用文本特征进行跨模态推理，采用TFE模块来扩展文本特征。TFE生成了空间特征的坐标编码，包含全体文本特征的词向量，以及浓缩特征的句子向量。前两者分别用于TCA和TCF模块，最后一个用于跨模态损失计算。

步骤三、文本引导的跨模态对齐；在之前提取的图像特征前插入一个预测词元作为初始的跨模态表示。为了对齐图文特征，采用注意力机制。在采用注意力机制前，需从指称表达中引入空间表示增强预测词元。然后采用多头自注意力机制和残差链接、层归一化用于更新、对齐视觉特征。

步骤四、文本引导的跨模态融合；采用跨模态注意力机制融合文本特征。对齐的图像特征作为query，文本特征作为key和value。文本引导的跨模态注意公式如下：

步骤五、预测头；基于最后一层输出的，经过充分学习的预测词元采用一个三层的FFN和sigmoid激活函数生成最终的预测框。

步骤六、损失和训练；为了训练LGR-NET，采用一个包含两项的损失函数；前者为预测框回归损失，后者为跨模态对齐损失。前者的损失用于帮助预测词元捕获所指对象的边缘特征；后者的损失促进其捕获与指称表达对象的语义一致性特征。

[0075] 批量大小用B表示，·代表内积运算。τ是可训练的温度参数，用于控制分布的平滑度。句子特征fsent由TFE输出，物体特征fp由预测词元生成。

[0076] fobj＝FFNojb(fp)

[0077] 公式表达中省略了层数下标。

[0078] 评估推理网络模型结果时，使用预测准确率作为指标。当预测框和真实框的交并比(IoU)大于0.5时，认为是一次正确预测。

[0079] 本发明提出LGR-NET模型，充分利用指称表达式的指导作用，通过预测词元捕捉跨模态特征，并通过TFE模块从三个方面扩展文本特征。

[0080] LGR-NET应用于REC任务，强调利用文本特征引导跨模态推理。文本生成的坐标嵌入、词嵌入和句子嵌入在跨模态推理中发挥关键作用。

[0081] 新颖的跨模态损失增强了跨模态对齐，通过文本特征的多角度引导，提高了模型性能。

[0082] 图1展示了本发明推理方法与传统方法在解决REC任务上的差异。

[0083] 图2为LGR-NET框架示意图。

[0084] 图3为推理方法的流程总览图。

[0085] 语言引导的指称表达理解推理网络系统包括文本特征提取器、图像特征提取器、TFE、TCA和TCF模块。

[0086] 文本特征提取器用于提取文本特征；图像特征提取器用于提取图像特征。

[0087] 使用预测词元捕获关键视觉和文本特征，通过TFE模块从三个方面扩展文本特征，参与跨模态推理。

[0088] 跨模态对齐模块用于输入和对齐损失计算；跨模态融合模块用于文本特征的融合。

[0089] 推理方法包括多模态特征提取、文本特征扩展、文本引导的跨模态对齐、跨模态融合和预测头步骤。

[0090] 使用Swin Transformer和BERT作为特征提取器，将特征投射到同一特征空间D。

[0091] TFE生成坐标编码、词向量和句子向量，用于TCA、TCF模块和跨模态损失计算。

[0092] 采用注意力机制和多头自注意力机制更新、对齐视觉特征。

[0093] 跨模态融合采用跨模态注意力机制。

[0094] 预测头使用三层FFN和sigmoid激活函数生成预测框。

[0095] 损失函数包括预测框回归损失和跨模态对齐损失，使用GIoU损失和L1损失。

[0096] 本发明通过具体实施例展示了其在REC任务上的应用，提高了推理准确性。