人脸重定向模型、模型训练方法及装置

本公开提供了一种人脸重定向模型、模型训练方法及装置，以提高视线估计算法的样本集质量。

人脸重定向模型包括编码器、无关属性分解模块、交叉属性分离模块和解码器。编码器用于对人脸图像进行特征提取，得到人脸特征。无关属性分解模块用于对人脸特征进行特征提取，得到对应于人脸特征的细节特征，包括身份特征、视线特征和头部特征。交叉属性分离模块用于对细节特征中的目标特征进行角度旋转，目标特征为视线特征或头部特征。解码器用于基于角度旋转后的细节特征生成新的人脸图像。

人脸重定向模型训练方法包括将第一人脸图像和第二人脸图像依次输入至编码器、无关属性分解模块、交叉属性分离模块中，得到第一细节特征、第二细节特征、角度旋转后的第一目标特征和角度旋转后的第二目标特征。将角度旋转后的第一目标特征交换至第二细节特征中，得到特征交换后的第一细节特征；将角度旋转后的第二目标特征交换至第一细节特征中，得到特征交换后的第二细节特征。将特征交换后的第一细节特征和特征交换后的第二细节特征输入至解码器中，生成对应于第一人脸图像的第三人脸图像和对应于第二人脸图像的第四人脸图像。基于第一人脸图像与第三人脸图像的相似度、以及第二人脸图像和第四人脸图像的相似度，对人脸重定向模型中各个模块的参数进行更新，以实现人脸重定向模型的训练。

人脸重定向模型训练装置包括特征提取模块、特征交换模块、图像生成模块和参数更新模块。特征提取模块用于提取第一人脸图像和第二人脸图像的细节特征。特征交换模块用于交换角度旋转后的目标特征。图像生成模块用于生成第三人脸图像和第四人脸图像。参数更新模块用于更新人脸重定向模型中各个模块的参数。

[0035] S102：交换角度旋转后的第一目标特征至第二细节特征，得到交换后的第一细节特征；相应地，交换角度旋转后的第二目标特征至第一细节特征，得到交换后的第二细节特征。

[0036] 在本实施例中，第一人脸图像Xa的视线特征经角度旋转后形成第一目标特征，第二人脸图像Xb的视线特征经角度旋转后形成第二目标特征。将第一目标特征交换至第二人脸图像Xb的细节特征中，模拟其视线特征；反之亦然。

[0037] S103：将交换后的细节特征输入解码器，生成与第一人脸图像对应的第三人脸图像和与第二人脸图像对应的第四人脸图像。

[0038] 在本实施例中，通过输入第一人脸图像Xa的身份特征、第二目标特征和头部特征至解码器，生成第三人脸图像；同理，输入第二人脸图像Xb的相应特征至解码器，生成第四人脸图像。

[0039] 本实施例通过交换视线特征和/或头部特征，解耦两者并保持其他特征不变，从而生成新的人脸图像，用于数据增广，提高样本集质量。

[0042] 在特征交换步骤之前，可交换两细节特征中的身份特征，促进交互式学习。

[0044] 在无关属性分解模块训练中加入正交损失函数，以使身份特征、视线特征和头部特征在隐空间中相互正交。

[0046] 人脸重定向模型训练方法包括计算对抗损失、重建损失和标签损失，通过加权求和得到总损失函数L。

[0056] 提供了人脸重定向模型训练装置的结构框图，包括特征提取模块、特征交换模块、图像生成模块和参数更新模块。

[0062] 参数更新模块包括正交损失函数计算，用于优化训练。

[0063] 描述了执行本公开实施例的电子设备，包括处理器、输入设备、输出设备和存储器。

[0065] 输入设备可以包括触控板、指纹传感器等，输出设备可以包括显示器、扬声器等。

[0067] 本公开实施例可执行于电子设备，提供了一种计算机可读存储介质，存储有执行本公开实施例的程序指令。

[0070] 本领域技术人员应理解，所描述的功能可以通过硬件或软件方式实现，取决于具体应用和设计约束。