本发明涉及一种图像生成模型的训练方法和设备以及图像生成方法。该方法包括获取样本数据，基于图像描述文本进行句子级别和词级别编码，得到句子向量和词向量。将初始高斯噪声输入图像生成模型的无条件对抗子网络生成第一图像，计算非条件对抗损失函数值。将第一图像和句子向量输入句子级别对抗子网络生成第二图像，计算句子级别的条件对抗损失函数值。将第二图像和词向量输入词级别对抗子网络生成第三图像，计算词级别的条件对抗损失函数值。利用损失函数值更新图像生成模型参数。该方法可保证生成图像与文本的一致性。

---

[0058] 本研究的第二步是获取样本数据，包括标准图像和对应的图像描述文本。

[0059] 图像描述文本用于描述标准图像，包含多种表述形式的描述语句。

[0060] 基于图像描述文本，进行句子级别和词级别的编码，得到相应的句子向量和词向量。

[0061] 采用预先训练的文本编码器（如Transformer）实现编码。

[0062] 使用初始高斯噪声作为输入，通过图像生成模型的无条件对抗子网络生成第一图像，并计算非条件对抗损失函数值。

[0063] 初始阶段使用随机高斯噪声以尽可能提升生成图像质量。

[0064] 第一判别器仅用于判断输入图像的真实性，无需考虑文本描述。

[0065] 高斯噪声经过重构和第一图像生成器处理，得到第一图像。

[0066] 重构方法为已知技术。

[0067] 第一图像通过三层上采样获得。

[0068] 非条件对抗损失函数值包括第一判别器和第一图像生成器的损失函数值。

[0069] 通过第一图像和标准图像，利用第一判别器计算非条件对抗损失函数值。

[0073] 将第一图像和第一句子的句子向量输入句子级别对抗子网络，生成第二图像，并计算句子级别的条件对抗损失函数值。

[0076] 句子向量与第一图像的图像特征融合。

[0077] 可以采用注意力机制或动态内存方法。

[0078] 第二图像生成器处理融合后的特征，得到第二图像。

[0079] 使用残差层和上采样层生成更高分辨率的第二图像。

[0080] 条件对抗损失函数值包括第二判别器和第二图像生成器的损失函数值。

[0082] 利用图像编码器抽取第二图像特征，进行图文一致性判断。

[0083] 采用交叉熵损失计算方法。

[0084] 计算第二判别器和第二图像生成器的损失函数值。

[0085] 在第三图像生成阶段，引入词向量进行图像优化。

[0086] 第三判别器用于评判图像与句子、词信息匹配程度。

[0087] 词向量与第二图像特征融合，生成第三图像。

[0088] 使用图像区域特征和词向量进行图文一致性判断。

[0089] 计算第四图文一致性损失函数值。

[0090] 加权计算损失函数值，以增强图文一致性。

[0091] 更新图像生成模型的参数。

[0112] 提供图像生成模型的训练设备，包括处理器和存储器。

[0113] 训练设备执行图像生成模型的训练方法。

[0114] 参数更新的具体方法为已知技术。

---