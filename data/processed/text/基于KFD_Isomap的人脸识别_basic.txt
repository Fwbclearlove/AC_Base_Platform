童塑蛆竖丛鲎燮L一．

． 2005年增：F nJ !鼍皇毫皇苎竺皇皇墨竺!烹皇J,——————————!!竺皇暑兰!詈鼍!苎烹兰!竺苎苎!!基烹!一!!竺皇墨．． I；IIII鼍!鼍鼍

基于KFD-l somap的人脸识别

李睿凡1郝红卫2涂序彦2王枞1

(1北京邮电大学信息工程学院北京 100876 2北京科技大学信息工程学院北京 100083)

摘要：神经生理学近来强调视觉以流形方式感知外部对象并提出Isomap的流形学习方法。该方法在数据描述等问题上取得

良好效果，但从模式分类观点看并非最优。以此提出KFD—Isomap算法，用核Fisher判别替代Isomap中的经典多维尺度分

析，并应用于人脸识别问题。两个人脸数据库的识别实验表明了该算法的有效性。

关键词：人脸识别流形Isomap核Fisher判别

出Fi媚she奔r警窆鎏。。轰警娄翌：警雹髦苎翌金矍譬堡。福南鑫典的多维尺度分析保持数据内在几何"舢J：--I：1岳91 o ：窦凳璧圭圣竺仝的耋粪善量≥?銎耋銎黧鏖妻耄 美景嚣i{芝孟吾茹差备冕#茹磊爻釜蒿筝裎意点间 警化等负厢因素，进而提高了人脸识别的准确率磊最美釜篙：1％蓑赢晨篇芝罴磊蒜轰奚亲：。霜墓蓄

L一／-,Jo戮羰警罂必视誊以懋搿嚣黧羹鬻赫兹嚣薹塞 耄毫!智竺鼍r粪‘翌。流形，简言之，是一个局部 茹羔聿：柘舅芸熹蕊巍i‘未爻：苯苡藁：雾蒜

欧式的拓耋。毫．舞。．：ⅢI、s左o。m～ap。(。Iso。mh七etr、i+c F、士ea+tu、r e 慧j。d：’炎军蕃丽造鬟‘鬻该运蒜内南：磊雾菘罴 M如ap．p。ingm)[4。一]晕黧氅曼黧窆量：孽耄鋈鬲蒜磊：磊磊篓茹要芸叠瑟磊罐二芸茹：”蒹箸夏芸 壅釜局警篓!曼曼苎．是曼墨曼，已芝警兰璺娶套 釜运蒿二117：kl篡"Ulld磊芏磊氯蟊囊釜蒿，量荔苗蕹蔷i’嘉 鎏甏：。竺要釜裂；掣鬈竺矍曼熙；娄萋煮宝窑三： 莩磊嚣内的点，。主粪磊蕞蓑矗善蕃衰赫蟊磊矗篙：。 掣苎譬婴享翌篓乡琶要望足譬。掣9景)曼紫潜在鎏 寿孚磊磊≤蒿酶善_鬲苗；篷曩嵩苫磊茧盖蔷篙拓 登墼毫耋2璺萼篓舞粤∑要曩二。怂恿，口!竺吧兰磊南莲美羞篙罱括并j。主击莆美鬓晶；蕹黄羞棼薪 法用点间的欧氏距离估计点问的测地线距离，然后 “””。一～”⋯“～”一⋯“”一一～’一一一“⋯

童王型量董仪器学报

2005年增刊I

IIIIII

"-． 竺寰毫皇一一

．i ；II罡苎鼍!竺苎苎苎竺釜≤兰圭釜

处理图矩阵，得到保持几何结构的内嵌流形。算法

的实现细节见文献f41。

尽管Isomap的非线性流形学习方法在数据的

维数约简与数据可视化等数据描述问题上表现出

良好的性能。但是，从模式分类的观点看，其数据

处理方式并非是最优的。首先，它目标是保持最小

的数据重建误差，而非区分不同类别；其次，它要

求良好采样的样本数据集，而实际模式分类应用的

很多场合却是数据的稀疏，这在人脸识别问题上较

为突出。最后，其获取的从输入空问到嵌套空间映

射为隐式表达，因此与数据可视化相比，Isomap对 于模式分类问题还需要额外的步骤，即用广义回归

神经网络[5]等非线性拟合方法获得映射的显式表

达。基于第一点的考虑，Vang[6]提出了Ext．Isomap

算法，将Fisher线性判别的方法引入到Isomap中， 替代多维尺度分析寻找最佳投影方向。

本文提出将基于核函数的Fisher判别方法引入

Isomap算法。与Isomap、Ext．Isomap相比，该算法 对于测地线距离的估计采用相同的方法，然后将测

地线距离矩阵的列向量作为核Fisher判别的输入特

征向量以寻找最佳投影方向。最后使用两个人脸数

据库，比较KFD．Isomap、Isomap、Ext．Isomap、特 征脸、Fisher脸等识别算法，实验结果表明了该方

法的有效性。

2 KFD-I somap算法

一般地，考虑集合x：l I。置，C为子集数， V12l‘

即样本类别；>!?，I'li=刀，％为每类样本数，行为

样本总数；薯∈R川，每个样本属于Ⅳ维空间。首

先用欧式距离度量以(五，Xj)=0薯一x『|l，计算样本

集中任意两点之间的欧式距离，用以确定任意一个

样本点薯的邻域。K．Isomap取与点一较近的K个

点作为该点的邻域；占．Isomap将以该点为球心，

以s为半径的超球内的点作为邻域。接着，可以将

点间的邻域关系表示为带权值的图G，即，如果五

与x。有邻接关系， 则矩阵G的元素

G=以(薯，x，)；否则q=oo。

然后，依据邻接关系图G估计嵌套流形M上

的测地线距离九(薯，x，)。对于邻近点誓和x，，其

测地线距离即为如(x，，x，)；对于非邻域点，可以

采取Floyd算法，即：

吨(誓，x，)=min(dz(誓，x，)，比(誓，％)+吃(％，x，))

进一步，将图矩阵G记为{91，92，⋯，g。)，g，为对

应于样本Xi的特征向量。

以上的处理与Isomap算法一致。接着，Isomap 算法以图G作为经典的多维尺度分析的输入，找到

嵌套的本征结构；Ext．Isomap则以每个样本点对应

的测地线距离矢量作为Fisher线性判别的输入，寻

找最佳的投影矩阵。本文采用核Fisher判别对测地

线距离矢量进行处理，先将其映射到高维核空间，

然后用Fisher线性判别寻找最佳投影矩阵，使其在

分类意义上最优，利用核函数将高维空间中的点积

运算转换为输入空间中函数求值简化计算。

假定非线性映射西：Rg_R，，R／为高维特征

空间，有厂≥g。那么，定义高维特征空间中的类 内离散度矩阵与类问离散度矩阵分别如下：

&=∑∑(矽(岛)一∥)(≯(岛)一∥?)r (1)

町=∑n,(ju?-p9)(∥?一∥9)r (2)

其中，U?与U≯分别为映射空间上样本类f的均值与

总体均值且甜?2去∑羔。毋，“9 2吉∑2。g，。

如果．叉为非奇异矩阵，则最优的投影％可

以由使得类间离散度矩阵与类内离散度矩阵的行 列式比值最大的正交列向量构成，即最佳投影矩阵

肾arg严嘲(3)

呢，由町和s：的广义特征向量组成，其列向量w

为较大特征值旯对应的特征向量，即广义特征方 程，s；w=A&w。

依据核的复制理论【7】，任意的w都是样本特征 向量的线性组合，即：

w=∑：。口，矽(岛)=①口 (4)

其中，①=[矽(＆)，矽(92)，⋯，矽(岛)】，系数列向量

口=[口l，口2，⋯，口。】丁。

皇兰型湮I皇垡量堂塑 2005年增刊 !苎詈皇鼍I————————i—J———．—．——．—．—．———————一——

II ’i釜釜

图2 ORL人脸数据库中部分图像

将矽(岛)投影到w_L，利用(4)有：

Wr≯(邑)=(①口)r矽(毋)

=口1①1痧(g，)

：ar[k(91,g。j)，．一，七(岛，删’(5)

-'Or’乞j

这里，旬=【七(＆，gj)，k(92，g／)，⋯，k(g。，g埘r；

同时，核函数k(x,y)=<x·Y>，<x·y>为点积 运算。其中的核函数可以为高斯径向基函数

k(x，y)=exp(一IIx—y12Ic)，或多项式核函数

k(x，J，)=@·y)d，其中的C、d均为正常数。

wr∥；=Or 71聊J

wr∥≯=口rm

其中，％：古l羔七(蜀，＆)，⋯，兰后(岛，&)11

L i=1 J=l J

r H " 1r 朋=古l∑七(岛，岛)，⋯，∑七(＆，昌)l

L i=1 i=I J

考虑(3)的分子、分母可以得到：

wrgw=ctrKba Wr&w=口rKwct

其中，％=∑知(聊，-m)(m，一聊)7’

Kw=∑2，∑_％(乞一％)(旬一小，)r

那么，有如下的广义特征值问题，

图3 Yale人脸数据库中部分图像

对于类内的离散度矩阵瓦，的奇异性，可以采

用两种方式进行处理：给瓦，的每个对角线元素加 上一小正数，改变其为非奇异矩阵，即

K。=Kw+crI，仃为一个足够小的正数；或者采

用主成分分析的方法，见文献【8】。

如果有待测试样本Y，那么其在W方向上的投

影可以计算如下：

W。矽(J，)=口7西。矽(y)

=口。【忌(蜀，J，)，k(92，y)，⋯，七(＆，J，)】1

至此，KFD．Isomap算法用于模式分类的流程 可小结如下：

构建邻域图：计算输入空间任意点问的欧式距离，

定义每个点的邻域，邻域图G的权值为点间距离0

1)计算最短路径：用Floyd算法求取图中点的最

2) 确定投影向量：将每个点表达为图矩阵的特征

向量，使用核Fisher判别求解广义特征值问题。

分类测试样本：构造一个广义回归神经网络， 映

射测试样本到权值图，并用核Fisher判别投影矩阵

将特征映射到予空间，最后用最近邻分类器确定其

3人脸识别实验

为检验改进算法的有效性，本文用

KFD—isomap、Isomap、Ext-Isomap、特征脸、Fisher 脸等对ORL和Yale两个人脸数据库进行了人脸识

别实验。ORL人脸数据库包含36位男性和4位女 性，每人10幅图像，共400幅面部图像，每幅图 像为112×92象素，256灰度级。图像包括光照、 表情(眼睛的开闭、是否微笑)和面部细节(是否 佩戴眼镜)等成像条件的轻微变化。其图像实例如

图2。为减少计算量，图像被重采样为56×46象素

篁型竖童幽竖兰塑 ．一

． 2005年增刊

大小。Yale人脸数据库包括15个人，大小为320

×243的165幅人脸图像。图像包含光照、面部表 情、及是否佩戴眼镜等成像条件的较大变化。为减 少背景图像的干扰，图像被裁剪为192x236大小，

然后重采样为48×59大小以减少计算量。图3为

部分裁剪后的样本图像。

实验中，将每个图像看成高维空间中的点，每

幅图像表示为一个列向量。先进行数据的归一化处

理，即将数据变换为均值为零，方差为一的列向量

表1 0RL数据库实验结果

方法 邻域参数降维空间错误率(％)

Eigenface NA 35 3．OO

Fisherface NA 39 1．75

Isomap 占=12 45 3．50

Ext-Isomap S=12 39 1．25

KFD．Isomap s=15 39 0．75

表2 Yale数据库实验结果 方法 邻域参数 降维空间错误率(％)

Eigenface NA 35 26．67

Fishefface NA 14 9．70

Isomap 占=15 40 26．06

Ext-Isomap 占212 14 19．39

KFD。Isomap S=15 14 8．48 ●■■●■■●■■■■●■■■■●一I I■●■■■■■■■●●■●■●■■■■■■■■■■●■■■■■●●●●■■■■■●■■■●●■■■■■■●●■■●■■■■■■●■■■■- 集合，然后分别用上述五种算法作为特征提取的步

骤，在子空间上采用最近邻分类器。数据集合的组

织采取leave．one．out策略，即每次将行一1个样本作

为训练集，剩余的一个样本作为测试集。算法中的

参数由实验确定。文献【71的人脸实验表明，s邻域

定义比K邻域定义有较好的实验结果，所以，文中

只考虑s的邻域定义。另外，多项式核函数采用平

方次d为2核函数。

两个人脸数据库的实验结果如表一、二。

KFD．Isomap在几种方法中表现出最好的性能。由

于基于主成分分析的特征脸与基于多维尺度分析

的Isomap方法都从重建误差最小的角度出发，所

以它们具有类似的识别效果。KFD．Isomap与

Ext．Isomap方法中判别分析的引入，使得Isomap

方法的识别率有较大提高。

提出了一种用核Fisher判别函数改进的Isomap ——KFD-Isom印进行特征提取，并用于人脸识别

的方法。该方法用测地线距离矩阵的列向量作为特

征，并用核Fisher判别替代多维尺度分析建立最佳

投影方向。人脸识别实验中，以基予Isomap的算 法作为特征提取手段，并使用最近邻分类器与特征

脸、Fisher脸算法进行了比较。两个人脸数据库的

实验表明该方法的性能优予实验采用的其它方法。 此外，该方法还可应用于其它模式分类问题。

【l】w．Zhao，R．Cheilappa,P．J．Phillips,and A．Rosenfeld,

”Face recognition：A literature survey,“ACM Computing

Surveys,v01．35，10P．399-458，2003．

f2]M．·H．Yang，”Kernel Eigenfaces VS．kernel Fisherfaces：face

recognition using kernel methods．”presented砒Proceedings

of the Third IEEE International Conference on Automatic

Face and Gesture Recognition,14·16 April 2002．2002．

13]H．S．Seung and D．D．Lee，”ne manifold ways of

perception,”Science，v01．290，PP．2268-2269，2000．

【4】J．B．Tenenbaum,V．d．Silva,and J．C．Langford,”A global

geometric framework for nonlinear dimensionality

reduccion，”Science,v01．290，pp．23 1 9-2323，2000．

【5]D．E Specht，”A general regression neural network,”IEEE

Transactions On Neural network,v01．2，仰．568．576，1991．

【6】M．H．Yang,”Extended isomap for pattern classification，”

presented at 18th National Conference on Artificial

Intelligence(AAAI-02)，Jul 28-Aug l 2002，Edmonton,Alta．，

Canada，2002．

【7】S．Mika,G Ratsch，J．Weston,B．Scholkopf,and K．R．

Muller,”Fisher discriminant analysis with kernels,”

presented at Neural Networks for Signal Processing-

Proceedings of the IEEE Workshop,Madison，Wl，USA，

【8】P．N．Belhumeur,J．P．Hespanha,and D．J．Kriegman,

”Eigenfaces VS．fisherfaces：recognition using class specific

linear projection,”IEEE Transactions on Paaem Analysis

and Machine Intelligence，v01．19，PP．711-720，1997．

李睿凡：男，1975年生。1998年，2001年毕业于华中理工

大学分获工学学士、工学硕士学位。现北京邮电大学攻读信

号与信息处理博士学位，主要研究方向为：模式识别、机器

学习与计算机视觉。