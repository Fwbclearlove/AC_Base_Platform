(19)中华人民共和国国家知识产权局

(12)发明专利

(10)授权公告号 (45)授权公告日

(21)申请号201410797791.5

(22)申请日2014.12.18

(65)同一申请的已公布的文献号

申请公布号CN 104462485 A

(43)申请公布日2015.03.25

(73)专利权人北京邮电大学

地址100876 北京市海淀区西土城路10号

(72)发明人李睿凡 芦效峰 鲁鹏 冯方向 李蕾 刘咏彬 王小捷

(74)专利代理机构北京德琦知识产权代理有限

公司 11018 代理人谢安昆 宋志强

(51)Int.Cl.

G06F 17/30(2006.01)

(56)对比文件

CN 103793507 A,2014.05.14, 何宁.《图像检索中跨模语义信息获取方法 研究》.《CNKI》.2013,正文第1-43页.

审查员高丹丹

(54)发明名称

一种基于对应的深层信念网络的跨模态检 索方法 (57)摘要

本发明提出了一种基于对应的深层信念网 络的跨模态检索方法，该方法包括：利用特征提 取方法分别获得检索目标与检索库中每一个检 索成员的初级向量；检索目标的初级向量分别与 检索库中每一个检索成员的初级向量，通过对应 的深层信念网络获得检索目标的高级向量和检 索库中每一个检索成员的高级向量；利用检索目 标的高级向量和检索库中每一个检索成员的高 级向量计算检索目标与检索库中每一个检索成 员的距离；将检索库中与检索目标距离最近的至 少一个检索成员确定为与检索目标匹配的对象。

权利要求书2页 说明书6页 附图4页

CN 104462485 B 2017.12.05

CN 104462485 B

1.一种基于对应的深层信念网络的跨模态检索方法，其特征在于，该方法包括： 利用特征提取方法分别获得检索目标与检索库中每一个检索成员的初级向量； 将所述检索目标和所述检索库中每一个检索成员分别作为第一模态和第二模态，将所 述检索目标的初级向量分别与所述检索库中该检索成员的初级向量作为一个组合，通过对 应的深层信念网络对组合中的所述检索目标的初级向量和该检索成员的初级向量进行处 理，获得所述检索目标的高级向量和该检索成员的高级向量；

利用所述检索目标的高级向量和所述检索库中每一个检索成员的高级向量计算所述 检索目标与所述检索库中每一个检索成员的距离；

将所述检索库中与所述检索目标距离最近的至少一个检索成员确定为与所述检索目 标匹配的对象。

2.根据权利要求1所述的方法，其特征在于，所述对应的深层信念网络Corr-DBN的非顶 层为至少一层双受限波尔兹曼机RBM结构，顶层为对应的受限波尔兹曼机Corr-RBM结构，所 述双RBM包括相互独立的第一模态RBM和第二模态RBM，所述Corr-RBM包括具有相关性约束 的第一模态Corr-RBM和第二模态Corr-RBM。

3.根据权利要求2所述的方法，其特征在于，所述第一模态Corr-RBM与所述第二模态 Corr-RBM包含有相同的可见层神经单元数目，所述第一模态Corr-RBM与所述第二模态 Corr-RBM包含有相同的隐藏层神经单元数目，所述第一模态Corr-RBM与所述第二模态 Corr-RBM的隐藏层之间具有相关性约束。

4.根据权利要求3所述的方法，其特征在于，该方法进一步包括： 所述Corr-RBM的配置参数Θ＝{WI,CI,BI,WT,CT,BT}，其中，上标I表示第一模态，上标T 表示第二模态，具体地，WI为第一模态Corr-RBM的各可见层神经单元与隐藏层神经单元之 间的连接权值参数集合，CI为第一模态Corr-RBM的可见层神经单元偏置参数集合，BI为第一 模态Corr-RBM的隐藏层神经单元偏置参数集合，WT为第二模态Corr-RBM的各可见层神经单 元与隐藏层神经单元之间的连接权值参数集合，CT为第二模态Corr-RBM的可见层神经单元 偏置参数集合，BT为第二模态Corr-RBM的隐藏层神经单元偏置参数集合；

所述Corr-RBM的配置参数Θ为令目标函数Q＝l D+αl I+βl T最小的配置参数，且

其中，lD为第一模态与第二模态在嵌套空间上的距离，lI为第一模态的负对数似然函 数，lT为第二模态的负对数似然函数，α和β是常数，且α∈(0,1)，β∈(0,1)；fI(·)是第一模 态Corr-RBM可见层到隐藏层的映射函数，fT(·)和第二模态Corr-RBM可见层到隐藏层的映 射函数；pI(·)为第一模态Corr-RBM可见层和隐藏层神经单元的联合概率分布，pT(·)为第 二模态Corr-RBM可见层和隐藏层神经单元的联合概率分布；||·||为二范数映射。

5.根据权利要求4所述的方法，其特征在于，根据目标函数Q确定Θ的算法为： A、第一模态Corr-RBM的可见层神经单元与隐藏层神经单元之间的连接权值参数集合

可见层神经单元 的偏置 和隐藏层神经单元 的偏置 用θI统一表示，根据公式θI

←θI +τ·α· △θI 进行更新，其中τ为学习速率，且τ∈( 0 ,1 ) ；α∈( 0 ,1 ) ；

权 利 要 求 书 1/2 页

CN 104462485 B

其中，<·>data为经验分布下的数学期望，<·>model为模型分布下的数学期望； B、第二模态Corr-RBM的可见层神经单元与隐藏层神经单元之间的连接权值参数集合

可见层神经单元 的偏置 和隐藏层神经单元 的偏置 用θT统一表示，根据公式θT

←θT+τ·β·△θT进行更新，其中，β∈(0,1)； 并且，

C、根据以下公式使用梯度下降的方法更新lD：

其中，δ'(·)＝δ(·)(1-δ(·))，且δ(·)为Logistic激活函数δ(x)＝1/(1+exp(-x))； 重复步骤A～C，直至该算法收敛。

权 利 要 求 书 2/2 页

CN 104462485 B

一种基于对应的深层信念网络的跨模态检索方法

[0001] 本发明涉及多媒体检索技术,特别是一种基于对应的深层信念网络的跨模态检索 方法。

[0002] 近些年互联网的发展使得多模态的数据呈现爆炸式增长。例如，电子商务网站上 的产品通常包含主干文字、简短的文本描述、以及相关的图片；社交网站上分享的图片通常 伴有标记的描述词；一些在线新闻上包含的图片和视频信息比单纯的文字报道更具有吸引 力，多模态数据的快速增长带来了巨大的跨模态检索需求。

[0003] 与传统的单模态检索不同，跨模态检索更多关注不同模态间的关系。因此，跨模态 检索问题包含两个挑战问题：一是来自不同模态的数据具有完全不同的统计特性，这使得 很难直接获得不同模态数据的关联关系；二是从不同模态数据中抽取的特征通常具有高维 的特性并且数据集的规模非常大，这使得高效的检索不容易实现。

[0004] 有鉴于此，本发明提供了一种基于对应的深层信念网络(Correspondence Deep Belief Network，Corr-DBN)的跨模态检索方法，应用Corr-DBN解决跨模态数据的处理问 题，使得经Corr-DBN处理后的跨模态数据能够高效的进行距离计算，从而得到较优的检索 结果。本发明提出的技术方案是：

[0005] 一种基于Corr-DBN的跨模态检索方法，该方法包括：

[0006] 利用特征提取方法分别获得检索目标与检索库中每一个检索成员的初级向量；

[0007] 将所述检索目标和所述检索库中每一个检索成员分别作为第一模态和第二模态， 将所述检索目标的初级向量分别与该检索成员的初级向量作为一个组合，通过对应的深层 信念网络Corr-DBN对组合中的所述检索目标的初级向量和该检索成员的初级向量进行处 理，获得所述检索目标的高级向量和该检索成员的高级向量；

[0008] 利用所述检索目标的高级向量和所述检索库中每一个检索成员的高级向量计算 所述检索目标与所述检索库中每一个检索成员的距离；

[0009] 将所述检索库中与所述检索目标距离最近的至少一个检索成员确定为与所述检 索目标匹配的对象。

[0010] 综上所述，本发明技术方案提出了一种基于对应的深层信念网络的跨模态检索方 法，对于跨模态原始数据进行特征提取获得的初级向量，通过对应的深层信念网络Corr- DBN的处理，得到跨模态数据在相同表示空间中的低维高级向量，进而对跨模态数据的低维 高级向量进行距离计算，根据距离确定检索结果。

[0011] 图1为本发明技术方案的流程图；

说 明 书 1/6 页

CN 104462485 B

[0012] 图2为本发明Corr-DBN神经网络结构图；

[0013] 图3为本发明双受限波尔兹曼机的神经网络结构图；

[0014] 图4为受限波尔兹曼机模型的结构图；

[0015] 图5为对应的受限波尔兹曼机模型的结构图；

[0016] 图6为根据目标函数Q确定Θ的方法流程图；

[0017] 图7为本发明实施例的流程图。

具体实施方式

[0018] 为解决跨模态间的检索问题，本发明提出一种基于对应的深层信念网络Corr-DBN 的跨模态检索方法，本发明技术方案的流程图如图1所示，包括以下步骤：

[0019] 步骤101：利用特征提取方法分别获得检索目标与检索库中每一个检索成员的初 级向量。

[0020] 本步骤中，为在检索库中检索与检索目标匹配的对象，首先需要对检索目标和检 索库中每一检索成员进行初级向量的获取，而特征提取方法获得的初级向量一般维数较 高，且不同模态的初级向量元素各异，一般不能直接用于检索运算。

[0021] 步骤102：检索目标的初级向量分别与检索库中每一个检索成员的初级向量，通过 对应的深层信念网络Corr-DBN获得检索目标的高级向量和检索库中每一个检索成员的高 级向量。

[0022] 本步骤中，将检索目标的初级向量分别与检索库中每一个检索成员的初级向量作 为一个组合，通过对应的深层信念网络Corr-DBN获得检索目标的高级向量和检索库中每一 个检索成员的高级向量。通过对应的深层信念网络Corr-DBN得到的检索目标的高级向量和 检索库中每一个检索成员的高级向量具有低维、空间元素一致等特点，能够高效的直接进 行检索运算。

[0023] 具体地，可以将检索目标作为第一模态，将任一个检索成员作为第二模态，Corr- DBN通过处理第一模态与第二模态的初级向量，最终输出第一模态与第二模态的高级向量。

[0024] 步骤103：利用检索目标的高级向量和检索库中每一个检索成员的高级向量计算 检索目标与检索库中任一检索成员的距离。

[0025] 具体地，可以用欧氏距离表示检索目标与检索库中每一个检索成员的距离。

[0026] 步骤104：将检索库中与检索目标距离最近的至少一个检索成员确定为与检索目 标匹配的对象。

[0027] 本步骤中，将检索库中每个检索成员与检索目标的距离进行排序，选择距离检索 目标最近的至少一个检索成员确定为与检索目标匹配的对象。

[0028] 本发明提出了一种使用对应的深层信念网络Corr-DBN进行跨模态检索的方法，图 2为本发明对应的深层信念网络Corr-DBN神经网络结构图，如图2所示，Corr-DBN首先对两 种模态的初级向量使用至少一层双受限波尔兹曼机(Restricted Boltzmann Machine， RBM)模型获得该两种模态的中级向量，在Corr-DBN模型的顶层通过Corr-RBM模型对两种模 态的中级向量进行进一步处理，最终获得两种模态的高级向量。下面分别对双RBM模型、 Corr-RBM模型以及Corr-DBN模型进行详细介绍。

[0029] (一)双RBM模型：

说 明 书 2/6 页

CN 104462485 B

[0030] 图3为双RBM的神经网络结构图，如图3所示，双RBM模型包括第一模态RBM模型和第 二模态RBM模型，第一模态RBM模型和第二模态RBM模型为相互独立的两个单RBM模型，第一 模态RBM模型对第一模态向量进行处理，第二模态RBM模型对第二模态向量进行处理，且第 一模态RBM模型和第二模态RBM模型之间无连接。下面仅对第一模态RBM模型进行介绍，第二 模态RBM模型的结构及参数设计与第一模态RBM结构相同。

[0031] 图4为第一模态RBM模型的神经网络结构图，如图4所示，第一模态RBM模型的可见 层V包含m个神经单元v1～vm，每个神经单元vi的偏置为bi，可见层神经单元之间没有连接； 隐藏层H包含s个神经单元h1～hs，每个神经单元hj的偏置为cj，可见层神经单元之间没有连 接；可见层神经单元vi与隐藏层神经单元hj的连接权值为wij。为了便于理解，图4中仅画出 了部分可见层神经单元与隐藏层神经单元的连接权值。

[0032] 单RBM具有无向图的结构，具有Logistic激活函数δ(x)＝1/(1+exp(-x))，则可见 层V和隐藏层H神经单元的联合概率分布为：

[0033]

[0034] 其中，Z为归一化常数，E(v,h)是由RBM的可见层神经单元、隐藏层神经单元的不同 配置定义的能量函数，根据可见层神经单元、隐藏层神经单元的不同配置，E(v,h)有不同的 表示，即只要RBM的可见层神经单元配置与隐藏层神经单元配置确定，就有相应的能量函 数，在此不作详细介绍。

[0035] 双RBM模型的参数包括：第一模态RBM的可见层神经单元与隐藏层神经单元之间的 连接权值参数集合、可见层神经单元的偏置集合和隐藏层神经单元的偏置集合，第二模态 RBM的可见层神经单元与隐藏层神经单元之间的连接权值参数集合、可见层神经单元的偏 置集合和隐藏层神经单元的偏置集合，上述参数可通过比照散度估计算法进行确定，比照 散度估记算法为现有技术，在此不再详细介绍。

[0036] (二)对应的受限波尔兹曼机Corr-RBM模型：

[0037] 图5为本发明Corr-RBM模型的结构图，如图5所示，Corr-RBM模型包含第一模态 Corr-RBM和第二模态Corr-RBM，第一模态Corr-RBM与第二模态Corr-RBM包含有相同的可见 层神经单元数目，第一模态Corr-RBM与第二模态Corr-RBM包含有相同的隐藏层神经单元数 目，并且第一模态Corr-RBM与所述第二模态Corr-RBM的隐藏层之间具有相关性约束。

[0038] 假定Θ表示Corr-RBM模型的参数集合,即Θ＝{WI,CI,BI,WT,CT,BT}，其中，上标I表 示第一模态，上标T表示第二模态，具体地，WI为第一模态Corr-RBM的各可见层神经单元与 隐藏层神经单元之间的连接权值参数集合，CI为第一模态Corr-RBM的可见层神经单元偏置 参数集合，BI为第一模态Corr-RBM的隐藏层神经单元偏置参数集合，WT为第二模态Corr-RBM 的各可见层神经单元与隐藏层神经单元之间的连接权值参数集合，CT为第二模态Corr-RBM 的可见层神经单元偏置参数集合，BT为第二模态Corr-RBM的隐藏层神经单元偏置参数集 合。

[0039] Corr-RBM模型的参数集合Θ通过下面的参数学习算法进行确定：

[0040] 根据下述原则定义目标函数T：Corr-RBM模型的参数集合Θ能够最小化第一模态 与第二模态在共享表示空间上的距离，以及最小化第一模态和第二模态的负对数似然函 数。目标函数Q为Q＝lD+αlI+βlT，即Θ为令Q最小的参数集合。

说 明 书 3/6 页

CN 104462485 B

[0041] 其中，

[0042]

[0043]

[0044]

[0045] 其中，lD为第一模态与第二模态在嵌套空间上的距离，lI为第一模态的负对数似然 函数，lT为第二模态的负对数似然函数，α和β是常数，α∈(0,1)，β∈(0,1)；fI(·)是第一模 态Corr-RBM可见层到隐藏层的映射函数，fT(·)是第二模态Corr-RBM可见层到隐藏层的映 射函数；pI(·)为第一模态Corr-RBM可见层和隐藏层神经单元的联合概率分布，pT(·)为第 二模态Corr-RBM可见层和隐藏层神经单元的联合概率分布，||·||为二范数映射。

[0046] 为了根据目标函数Q确定Θ，可以采用交替迭代的优化过程，首先对两个似然函数 lI和lT采用比照散度估记算法进行更新，然后使用梯度下降法更新lD，收敛性可以在验证集 上使用跨模态检索进行检测，具体地，图6为根据目标函数Q确定Θ的流程图，包括以下步 骤：

[0047] 步骤601：利用比照散度估记算法更新第一模态Corr-RBM的参数。

[0048] 第一模态Corr-RBM的可见层神经单元与隐藏层神经单元之间的连接权值参数集

合 可见层神经单元 的偏置 和隐藏层神经单元 的偏置 用θI统一表示，根据公式θI

←θI+τ·α·ΔθI进行更新，其中τ为学习速率，τ∈(0,1)；α∈(0,1)；

[0049]

[0050]

[0051]

[0052] 其中，<·>data为经验分布下的数学期望，<·>model为模型分布下的数学期望；

[0053] 步骤602：利用比照散度估记算法更新第二模态Corr-RBM的参数。

[0054] 第二模态Corr-RBM的可见层神经单元与隐藏层神经单元之间的连接权值参数集

合 可见层神经单元 的偏置 和隐藏层神经单元 的偏置 用θT统一表示，根据公式

θT←θT+τ·β·ΔθT进行更新，其中β∈(0,1)； 并且，

[0055]

[0056]

说 明 书 4/6 页

CN 104462485 B

[0057]

[0058] 步骤603：使用梯度下降的方法更新第一模态与第二模态在嵌套空间上的距离。

[0059] 具体地，根据以下公式使用梯度下降的方法更新第一模态与第二模态在嵌套空间 上的距离lD：

[0060]

[0061]

[0062]

[0063]

[0064] 其中，δ'(·)＝δ(·)(1-δ(·))，且δ(·)为Logistic激活函数δ(x)＝1/(1+exp(- x))。

[0065] 步骤604：重复步骤601～603，直至算法收敛。

[0066] 通过上述方法即可获得Corr-RBM模型的参数集合Θ。

[0067] (三)对应的深层信念网络Corr-DBN模型

[0068] 图2为Corr-DBN神经网络结构图，如图2所示，Corr-DBN的非顶层为至少一层双受 限波尔兹曼机RBM结构，顶层为对应的受限波尔兹曼机Corr-RBM结构，所述双RBM包括相互 独立的第一模态RBM和第二模态RBM，所述Corr-RBM包括具有相关性约束的第一模态Corr- RBM和第二模态Corr-RBM。Corr-DBN首先对两种模态的初级向量使用至少一层双RBM模型获 得该两种模态的中级向量，在Corr-DBN模型的顶层通过Corr-RBM模型对两种模态的中级向 量进行进一步处理，最终获得两种模态的高级向量。

[0069] 底层双RBM模型的第一模态RBM可见层神经单元的输入为第一模态原始数据经特 征提取获得的第一模态的初级向量，底层双RBM模型的第二模态RBM可见层神经单元的输入 为第二模态原始数据经特征提取获得的第二模态的初级向量，由原始数据经过特定提取获 得初级向量为现有技术，在此不作详细介绍。

[0070] 相邻两层双RBM模型中，上层双RBM的可见层神经单元个数等于下层双RBM隐藏层 神经单元的个数；相邻顶层Corr-RBM的可见层神经单元个数等于与该Corr-RBM相邻的双 RBM模型中的隐藏层神经单元个数。

[0071] 顶层Corr-RBM模型的第一Corr-RBM输出第一模态的高级向量，第二Corr-RBM输出 第二模态的高级向量。

[0072] 为使本发明的目的、技术方案和优点表达的更加清楚明白，下面结合附图及具体 实施例对本发明再作进一步详细的说明。

[0073] 本实施例假设检索库包括M个检索成员，以在该检索库中检索与文本J相关的对象 为例对本发明技术方案进行说明，图7为本实施例的流程图，如图7所示，包括以下步骤：

[0074] 步骤701：采用特征提取方法获得检索库中各检索成员的初级向量，以及文本J的 初级向量。

[0075] 本步骤中，检索库中的检索成员的模态种类不作限定，可能为图像模态，可能为文 本模态，也可能为语音模态，不同模态的原始数据目前均有较成熟的特征提取方法，例如图

说 明 书 5/6 页

CN 104462485 B

像模态可以应用MPEG-7和Gist描述符进行特征提取，文本模态可以应用词袋模型进行特征 提取等，在此不再对获得文本J以及检索库中各检索成员的初级向量的过程进行详细描述。

[0076] 步骤702：文本J的初级向量分别与检索库中每个检索成员的初级向量通过Corr- DBN模型处理，获得文本J的高级向量与检索库中每个检索成员的高级向量，再利用文本J的 高级向量与检索库中每个检索成员的的高级向量进行欧氏距离计算，计算文本J与检索库 中每个检索成员的欧氏距离。

[0077] 本步骤中，将检索库中任一个检索成员与文本J作为一个组合，通过Corr-DBN模型 对组合中的检索成员初级向量和文本J的初级向量进行处理，获得该组合中检索成员的高 级向量、文本J的高级向量，然后根据欧氏距离计算公式计算文本J与该检索成员的欧氏距 离。

[0078] 一般的,对于n 维欧式空间中的两点t 和y ,他们的距离d 的计算公式为

由于经过Corr-DBN模型得到的文本J的高级向量和任一检索成员的高级

向量为同维向量，以此计算文本J和任一检索成员的欧氏距离。

[0079] 步骤703：根据文本就与检索库中每个检索成员的欧氏距离由低到高进行排序，选 择排在前面的K个检索成员作为检索结果输出。

[0080] 本实施例通过Corr-DBN模型对文本模态的初级向量和检索库中各检索成员的初 级向量进行处理，获得各自的高级向量，再利用高级向量进行欧氏距离计算能够高效的获 得检索结果。

[0081] 以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精 神和原则之内所做的任何修改、等同替换、改进等，均应包含在本发明保护的范围之内。

说 明 书 6/6 页

CN 104462485 B

说 明 书 附 图 1/4 页

CN 104462485 B

说 明 书 附 图 2/4 页

CN 104462485 B

说 明 书 附 图 3/4 页

CN 104462485 B

说 明 书 附 图 4/4 页

CN 104462485 B