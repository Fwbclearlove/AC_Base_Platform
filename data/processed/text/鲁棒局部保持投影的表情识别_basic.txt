2006年11月 第29卷增刊

北京邮电大学学报

Journal of Beijing University of Posts and Telecommunications

Nov．2006

V01．29 Sup

文章编号：1007—5321(2006)增．0178—05

鲁棒局部保持投影的表情识别

李睿凡1，朱强生1，郭燕慧1，刘海涛2

(1．北京邮电大学信息工程学院，北京100876；2．中国民航大学通信工程系，天津300300)

摘要：针对局部保持投影的流形学习算法对于噪声与异常值的敏感性，提出了一种鲁棒的局部保持投影算法．其

基本出发点是首先对所有数据点进行评估，以获得它们可能成为异常值的信息，然后再将这种信息用于邻域选择与

低维嵌套中．采用鲁棒局部保持投影进行人脸的表示方法，对JAFFE表情数据库进行了实验，结果表明，该方法

关键词：局部保持投影；鲁棒性；表情识别

中图分类号：TN391 文献标识码：A

Robust Locality Preserving Projection for

Facial Expression Recognition

LI Rui—fanl，ZHU Qiang—shen91，GUO Yan-huil，LIU Hai-ta02

(1．School of Information Engineering，Beijing University of Posts and Telecommunications，Beijing 100876，China；

2．Department of Communications Engineering，Civil Aviation University of China,Tianjin 300300．China)

Abstract：Aiming at the sensitivity of manifold learning，such as locality preserving projection(LPP)，to

noises or outliers，a robust version of U)P，called Robust LPP(RLPP)，was proposed．By this algorithm，

all the data was firstly evaluated to obtain the possibility of data points as outliers．And then this

information was used for neighborhood selection and low—dimensional embedding．The RLPP was used

for the representation of facial images．The experimentS on JAFFE database showed the effectiveness of

this algorithm．

Key words：locality preserving projection；robustness；facial expression recognition

流形学习是当前人工智能和机器学习研究的

一个热点．自2000年《科学》杂志上发表了等距映

射[1]、局部保持嵌套[2]的流形学习方法以来，新方法

层出不穷，如拉普拉斯特征映射[3|，最大方差展开[41

等．虽然流形学习方法在高维数据分析川、数据可

视化、人脸识别吲等任务上取得了良好的效果．甚至

神经生理学研究也表明了流形在视觉感知中所起

的作用[6]．但是，流形学习算法在应用中需要面临的

一个重要问题是对噪声和异常值的敏感性．已有学

者对一些流形学习算法的异常值敏感性进行了

研究[7-9]．

本文针对局部保持投影算法对异常值的敏感

性提出了一种鲁棒的改进算法．该方法首先对每个

数据为异常值的可能性进行估计，然后将这种信息

引入到后续的邻域选择与嵌套中．从而可以获得鲁

棒的改进算法．

1局部保持投影

局部保持投影[5]算法是Laplace Beltrami算子

特征函数的一个线性估计，其目标是保持数据之间

收稿日期：2006—10—10

基金项目：国家自然科学基金项目(60496327)

作者简介：李窖凡(1975一)，男，博士，讲师，E-mail：liruifan@tom．tom．

增刊 李睿凡等：鲁棒局部保持投影的表情识别

的相似关系，即原始空间上相邻的数据点在投影空

间上也保持相应的邻近关系．假定数据集X={x。， 娩，⋯，斯}含有Ⅳ个样本点，每个样本点鼢属于D

欧式空间舻，即为∈艘样本数据来自一本征维数

为d(通常d<<D)的非线性流形．局部保持投影试

图将D维数据映射到另一全局坐标空间剜，找到D

维数空间中的嵌套．假定Ⅳ个数据点在嵌套空间

∥中的投影为y={鲂，耽，⋯，鳊}，局部保持投影算

法[5]可以包含3步．

1)对于样本集中的每个数据点Xi∈X确定一

个含有K个数据点的邻域；

2)根据邻域关系建立整体的邻接图，并选定相

似测度描述任意2个数据点之间的相似关系；

3)计算保持局部几何特征的局部嵌套．

上述步骤1)通常采用欧式距离作为邻域关系

的度量．那么，这样的邻域图就是局部流形结构的

基于邻域关系，步骤2)用式(1)刻画任意两点

之间的相似关系：

。 fexp(-IIx,一为Ⅳt)如果为，为互为邻域点 w

其中的t为一适当的常数．该式被称为热核方程no】．

局部保持投影的第3个步骤是计算局部嵌套．

其目标函数为

min乞(9‘一yj)2 S# (2)

同时具有约束条件矿oy，其中D为对角矩阵，其

元素为对称矩阵S的列向量(或行向量)元素之和，

即协=艺so．可以得到如下的特征方程：

XⅨ。埘=姬嘲1tp (3)

假定Wo，埘1’．一，叫出。为特征方程式(3)的d个解，它

们所对应的特征值分别为A。，A。，⋯，A扣。那么可以

得到如下映射：

xi。鱿=Wrxl (4)

其中，鼽为d维向量；W为变换矩阵．在计算时需 要考虑D的奇异性，可以采用主成分分析的方法，

详见文献[5]．

2鲁棒局部保持投影

鲁棒统计的主要思想是设计能降低分布偏差

影响的统计过程，从而得到对于分布具有鲁棒性的

统计算法．本文提出的鲁棒局部保持投影首先在样

本数据集X上执行局部鲁棒主成分分析．而鲁棒主

成分分析则利用了带权值的主成分分析算法．这

样，可以得到来自潜在流形上的样本数据的可能性

度量．而这种可能性度量可以被看成是每个数据点

是异常值的度量．一旦识别出可能的异常值，就可

以在随后的局部保持投影算法中削弱它们对于整

个算法的影响．

2．1带权值的主成分分析

主成分分析的目的是构造一个d维的子空间，

原始D维数据在该空间上的投影在最小均方意义

上是最优的．对于局部保持投影步骤1中所获得的

髟邻域采用主成分分析，可以得到关于这个髟个数

据点的主成分分析．进一步给定一个非负的权值集

合A={a，，a2，⋯，吼}，其元素与K个邻域点一一对

应．那么，可以将得到如下带有权值的均方误差优

臣∞。=乞q ll岛l{2 (5) j=1

容易得到最小均方估计即为带权值的样本均值：

置 置 ／x。=∑q屯／∑q (6) 』=1 j=1

而相应的协方差矩阵为

，三 c =古艺口f(x‘一肌)(x‘一纵)7 (7) 』L J=1

上述求解被称为带权值的主成分分析．为消除K邻

域中潜在异常值的影响，期望它们在集合A中所对

应的权值尽可能小．换句话说，如果与数据冀。相应

的误差范数ll ej ll较大时，那么需要将该数据所对

应的权值ai设置较小．这样的权值可以通过鲁棒估

计的方法获得，从而将带权值的主成分分析改造成

鲁棒主成分分析．

2．2鲁棒主成分分析

上述带权值的主成分分析方法假定了集合A

为已知的固定常数．需要使集合A取决于估计误差

￡；，才能将带权值的主成分分析改造为鲁棒主成分

分析．另一方面，估计误差ej又取决于均值和协方

差矩阵，而它们反过来取决于A．由于这种互相依

赖的关系，可以采用迭代估计进行求解．这一迭代 过程被称为权值更新的迭代最小均方，简称

IRLS L11】．其过程如下：

1)使用标准主成分分析找到样本均值向量h

北京邮电大学学报 第29卷

和样本协方差矩阵B的初始最小均方估计，分别记

为h‘。’和B‘∽．并设置f：0．

2)重复以下步骤： ①t=t+1；

②计算￡f(t-1)：xf。一 ‘¨’-B‘¨’(B‘“1’)T(X／ ‘卜¨)；

④计算∥’和jEI“’有权值的均方估计，由权值

集合A“1’对矩阵X执行带权值的主成分分析；直

到 ‘‘’和B‘‘’从h(t-1)和B‘川不发生较大改变．其中，

假定口(·)为一权值函数，确定了由误差范数ej=Ei“1’ 所给定的权值aj=n(勺)=a(||q 1)．可以将最小

均方估计器替换为一个鲁棒估计器，使

耳=∑p(ej)：∑p(№l|)

最小．其中，p(·)为一凸函数．

使用Huber函数

l}已2 P I≤c p(P)={z ． c(I P I)一}c I已I≤c

其中，C为某大于零的实数．那么，权值函数可以定

础，=世e=巡e={鲁能e

l_T二—广 l>C

其中咖(·)为效用函数，是函数P(·)的一阶导数．权 值函数使得权值更新的迭代最小均方过程执行鲁

棒主成分分析的M估计．实验中，参数C设置为K

邻域样本点残差均值的一半，即c=o．5K∑ej．

2．3鲁棒局部保持投影算法

使用权值更新的迭代最小均方过程可以给出

和曰的带权值的最小均方估计．同时，每个邻域点

Xi则对应于一个权值．这样，可以将所有的权值

进,行归一化处理．假定aj归一化权值为a，，那么口，=

aj／∑陬．这种标准化的权值可以用于刻画每个麓

对应邻域的可靠性度量．对于不属于麓邻域中的

点，其权值设置为零．通过对于集合A中的所有数

据点执行鲁棒主成分分析，可以将鲁棒主成分分析

标准化后的结果求和得到对于每个点的总体可能

性估计&．某点％的估值函越小，那么该点成为异

常值的可能性越大．这样，由每个样本点的可能性

估值，就可能在后续的处理中采用不同的手段，削

弱它们对于整体数据处理的影响．这也是鲁棒局部

保持投影算法的主要思想．

假定基于可靠性估值获得对于数据点的评估

所得到的干净数据的集合为五．如果样本点麓的

可靠性估值Si≥d，Ol为某个大于零的阈值，那么为

即属于集合xc．这样，鲁棒局部保持投影算法可以

1)对于每个样本点鼍∈X有

①找到麓的K邻域集合Ⅳf，满足要求Ⅳicxc；

②依据选定的相似性测度，即热核方程，计算

任意两数据点之间的相似程度S，；

2)计算样本集合X的低维嵌套y，通过最小

化带有权值的目标函数

1n ● 咖+=乞(Yi一胁)2 SU

其中⋯S=岛sj&，黾和sf分别为样本点麓和xf的可

靠性估值，s。为样本点麓和为的热核值，见式(1)．

类似于局部保持投影算法的求解，可以将上述

最小化问题转化为如下特征值问题：

XL+X7∞=AXD+X‰

求解广义特征方程，可以得到x一鼽=W‰．其中 鱿为d维向量，W=[O．10，w1，．一，叫出。]为变换矩阵．

鲁棒局部保持投影算法的鲁棒性主要由于以

下2个原因：一方面，在算法的步骤1中，通过去除

具有高可能性的异常值，在邻域选择上给出一个更

为恰当的选择，使得热核值更能反映流形的局部几

何结构；另一方面，在算法的步骤2中，在代价函数

中引人数据点的可靠性评估值对数据点之间的热

核值进行修正，进一步削弱潜在异常值的影响．

鲁棒局部保持投影算法需要人为设置可靠性

评估的阈值参数Ot．注意到可靠性估值在整个样本

的均值i为1．那么，将阈值参数仅认为是面，即阈

值参数是可靠性估值在整个样本上的均值的一部

分．这使得阈值参数的设置具有可参照的对象．实

验表明，只要阈值参数仪适中，鲁棒局部保持投影

算法的性能不会对阈值参数有敏感性．

3表情识别实验

将鲁棒局部保持投影算法用于人脸表情识别

增刊 李睿凡等：鲁棒局部保持投影的表情识别

问题，以表情识别中常用的Gabor小波特征提取方

法作为参照，比较局部保持投影算法和鲁棒局部保

持投影算法性能上的差异，分类器采用最近邻分类

器．同时，人为地制造一些缺陷图像，考察算法的鲁

棒性，这在一定程度上模拟了脸部有遮蔽情形下的

表情分析．由于人与人之间表情的差异性，需要分

别考虑与人有关的表情识别和与人无关的表情识

别．前者是指实验中测试集图像中的人物包含于训

练集中；后者是指测试集中的图像所有人物都不包

含于训练集合图像的人物之中．

3．1原始图像的表情识别

针对静态图像的人脸表情识别问题，采用日本

JAFFE人脸表情数据库．JAFFE人脸表情数据库包

含10位El本女性的7种表情(6种基本表情，厌恶、

恐惧、高兴、惊讶、悲伤、愤怒和中性表情)，共213

幅图像．每个图像大小为256×256像素，256灰度

级．图1显示了这个数据库中的例子．图中，从左至

右的表情依次为中性、高兴、悲伤、惊讶、愤怒、厌恶

和恐惧；从上至下为4个不同的人物．考虑到噪声

干扰和计算效率，将每个图像的脸部区域分割出

来，大小为128×128．分割后的图像见图1．这3种

方法采用相同的图像大小．

图1 JAFFE人脸表情数据库图例

实验采用交叉验证的方法．数据集的划分采用

2种情况，分别对应于与人有关的表情识别和与人

无关的表情识别．第1种情况，先将整个数据集合

分成3部分，每个部分至少包含每个人每种表情一

幅图像．然后再将每个部分大致分成2份．每次将

其中的一份作为测试集，其余5份作为训练集．上

述过程重复6次，使得每个部分都有一次用作测试

集．第2种情况，将整个数据集分为大致图像数目

相等的10个部分，每个部分由同一人的所有不同

表情图像组成．每次将9个用作训练集和另外一个

用作测试集．上述过程重复10次，使得每个部分都

有一次用作测试集．

将二维Gabor小波作为特征提取的基线方法．

实验采用5种尺度、8个方向共40种Gabor小波．

人脸图像经过下采样后成为32×32大小的图像，

然后采用不同的小波对整个脸部区域进行卷积．得

到的二维小波变换再进行64的下采样．最终用640

维向量表示人脸图像．

对于局部保持投影和鲁棒局部保持投影，选择

K邻域方法判断数据点之间的邻域关系，采用热核

作为邻域点相似关系的度量，其邻域参数由实验确

定为K=10．热核中的参数f可以由实验确定．鲁

棒局部保持投影的可靠性评估阈值参数Ot=0．5．

图2表情图像加入随机块的图例

使用3种特征表达人脸之后，采用最近邻分类

器进行识别．对于与人有关的表隋识别，3种方法的

7类表情识别结果见图3．从总体上看，对于每类表

情，鲁棒局部保持投影的方法具有最好的识别率，

其次是Gabor小波的方法，最后是局部保持投影的

方法．在每类表情之间，愤怒、厌恶、恐惧的表情识

别率普遍低于其他类型的表情．

图3与人有关条件下的表隋识别结果比较

对于与人无关的表情识别，3种方法的7类表

情识别结果见图4．从总体上看，对于每类表情，鲁

棒局部保持投影的方法具有最好的识别率，其次是

Gabor小波的方法，最后是局部保持投影的方法．在

每类表情之间，悲伤、厌恶、恐惧的表情识别率普遍

低于其他类型的表情．与人有关的表情识别类似．

182 北京邮电大学学报 第29卷

同时注意到，与人无关的表情识别总体上都低于与

人有关的表情识别结果．

图4与人无关条件下的表情识别结果比较

3．2加入随机块的表情识别

为模拟面部带有眼镜等遮蔽物，或者图像遭受

不同程度的破坏情形的表情分析，部分图像被加入

随机图块．原始图像的大小为128×128，加入随机

图块的大小有3种，分别为16×16、24×24、32×32

像素．改变后的图像如图2所示．

数据集的划分采用2种情况，分别对应于与人

有关的表情识别和与人无关的表情识别．第1种情

况下，先将整个数据集合分成3部分，每个部分至

少包含每个人每种表情一幅图像．然后再将每个部

分大致分成2份．每次将其中的一份作为测试集，

其余5份作为训练集．上述过程重复6次，使得每

个部分都有一次用作测试集．第2种情况下，将整

个数据集分为大致图像数目相等的10个部分，每

个部分由同一人的所有不同表情图像组成．每次将

9个用作训练集和另外一个用作测试集．上述过程

重复10次，使得每个部分都有一次用作测试集．需

要注意的是，每次都是只针对测试集加入不同的随

机块，这种加入随机块的图像动态生成．数据集合

的划分与实验类似．实验采用交叉验证的方法．

图5和图6中，原始图像下的识别率最高．而

当随机块的大小增加时，识别率明显下降．在与人

有关的表情识别中，对于加入在32x32大小随机块

时，Gabor小波方法的识别率为38．0％，局部保持投

影方法的识别率为30．0％，鲁棒局部保持投影方法

的识别率为46．5％．这样，鲁棒局部保持投影具有最

好的识别结果，Gabor小波次之，最后是局部保持投

影方法．在与人无关的表情识别中，对于加人在

32×32大小随机块时，Gabor小波方法时的识别率

为31．9％，局部保持投影方法的识别率为28．2％，鲁

棒局部保持投影方法的识别率为39．9％．这样，在与

人无关的表情识别中，鲁棒局部保持投影具有最好

的识别结果，Gabor小波次之，最后是局部保持投影

方法．比较2种不同的情形可以发现相同的结果．

另外，当有未知人物的表情出现时，表情的识别率

会比相应情况下要低．

图5与人有关情形下含不同随机块的识别结果

图6与人无关情形下含不同随机块的识别结果

本文针对局部保持投影流形学习算法对于异

常值的敏感性，提出了鲁棒局部保持投影算法．其

基本出发点是先对所有数据点进行评估，以获得它

们可能成为异常值的信息，然后将这种信息用于邻

域选择与低维嵌套中．JAFFE数据库的表情识别实

验中，以Gabor小波为基准测试了算法性能．实验

结果表明鲁棒改进算法的有效性．由于IRLS需要

逐个数据评估，算法速度低．今后的工作中将考虑

加速算法以适应大规模计算问题．

l 1 j de Silva V，Tenenbaum J B，Langford J C．A global

geometric framework for nonlinear dimensionality

reduction[J]．Science，2000,290(22)：2219—2223。

l 2 J Roweis S T，Saul L K，Nonlmear dimensionality

reduction by locally linear embedding[J]．Science，2000，

290(22)：2223—2226．

(下转笫206页)

北京邮电大学学报 第29卷

计方法，以及翻译记忆库和术语库技术，避免了人

工翻译中重复劳动和术语不一致现象，有效地提高

翻译效率和翻译质量．在具体翻译过程中，人机分

工协作，由人完成创造性的工作，而机器随时协助

人翻译处理，自动提供已有的翻译记录和术语．同

时，机器不断学习人的翻译，作为以后翻译的基础．

通过辅助写作翻译系统，可以确保相同句子不被翻 译2次，类似甸子和短语可以提供范例，节省了大

量人工翻译中用于术语和短语查询的时间和相同

句子的重复翻译时间．

作为电脑语言辅助工具的计算机辅助写作翻

译系统，很大程度上改变了目前翻译软件的现状，

为翻译软件的开发提供了一个全新的思路，这一思

想已在国外同类软件中得到体现．

【1 J Hutchins W J．Latest Developments in MT technology：

beginning a new era in MT research【C J／／Proc of MT

Summit-IV．Japan：[s．n．]，1993：11-34．

1 2 J Hutchins W J．Machine translations：past，present and

future[M]．[S．1．]：England Ellis Horwood Ltd，1986．

[3]冯志伟．机器翻译——从梦想到现实[J]．中国翻译，

1999，19(4)：37—40．

Feng Zhiwei．Machine translation—dream realism[J]．Chi—

nese Translation，1999，19(4)：37—40．

q矿1驴、舻、帮、d卜《争电务《哥《铲《穸、扩、驴、驴、移、d 《争《争卅矿抄q铲叫妒、痧、够、五 《争d争《P{驴、驴、口、驴、矿、猡、驴、移、疹、西卜《h面 卅争卅争卅≯《争卅≯卅≯卅矿《矿叫垆、驴、驴、廖、够、乎、痧、驴谚

(上接第182页)

l 3 J Belkin M，Niyogi P．Laplacian eigenmaps and spectral

techniques for embedding and clustering[c]／／Die,erich

T G，Becker S．Ghahramani Z．Advances in Neural

Information Processing Systems．Cambridge：M11r Press．

2002：788～795．

【4 J Weinberger K Q，Packer B D，Saul L K．Nonlinear

dimensionality reduction by semidefinite programming

and kernel matrix factorization C l／／Cowell R G，

Ghahramani Z．Proceedings of the Tenth International

Workshop on AI and Smtistics．Savannah：Society for

Artificial Intelligence and Statistics．2005：381—388．

1 5 J He X，Niyogi P．Locality preserving projections【C]／／

Advances in Neural Information Processing Systems．

Cambridge：MIT Press．2004：327—334．

1 6 J Seung H S，Lee D D．111e manifold ways of perception

[J]．Science，2000，290(22)：2268—2269．

1 7 J de Ridder D，Franc V．Robust manifold learning lEB／

research／papers／ctu-cmp一2003—08．pdf．

[8]Chang H，Yeung，D Y．Robust locally linear embedding

lEB／OL]．200512006—09-10]．WWW．CS．ust．hk，～dyyeung／

papeffpdf／yeung．pr2006b．pdf

[9]Choi H，Choi S．Kernel isomap on noisy manifold[C]，，

IEEE International Conference on Development and

Learning．Osaka：[s．n．]，2005：19—21．

[10]Chung FR K．Spectral graph theory[M]．NY：American

Mathematical Society，1997．

1 11 j Street J O，Carroll R J，Ruppert D．A note on computing

robust regression estimates via iteratively reweighted

least squares[J 1．American Statistician，1988，42(2)：

】52-】54．