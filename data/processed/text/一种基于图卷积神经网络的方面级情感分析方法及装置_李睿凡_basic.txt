(19)中华人民共和国国家知识产权局

(12)发明专利申请

(10)申请公布号 (43)申请公布日

(21)申请号 202011463822.5

(22)申请日 2020.12.14

(71)申请人 北京邮电大学

地址 100876 北京市海淀区西土城路10号

(72)发明人 李睿凡 陈昊 冯方向 张光卫 王小捷

(74)专利代理机构 北京柏杉松知识产权代理事

务所(普通合伙) 11413 代理人 丁芸 马敬

(51)Int.Cl.

G06F 40/30(2020.01) G06F 40/211(2020.01) G06F 40/216(2020.01) G06F 40/284(2020.01) G06N 3/04(2006.01)

(54)发明名称

一种基于图卷积神经网络的方面级情感分 析方法及装置 (57)摘要

本发明实施例提供了一种基于图卷积神经 网络的方面级情感分析方法及装置，所述方法包 括：获取待进行方面情感分析的句子，以及该待 进行方面情感分析句子中的方面词；对待进行方 面情感分析的句子以及方面词进行预处理，得到 待进行方面情感分析的句子对应的输入向量序 列以及句法加权图；将输入向量序列和句法加权 图，输入预先训练的双重图卷积神经网络中，得 到方面词对应的情感分析结果。本发明实施例， 使用双重图卷积神经网络不仅关注句子的句法 特征，还关注句子的语义特征，提取句子对应的 语义相关特征，弥补了对句法不敏感的句子提取 句法特征不准确的缺陷，提高情感分析结果的准 确性。

权利要求书4页 说明书19页 附图5页

CN 112528672 A 2021.03.19

CN 112528672 A

1.一种基于图卷积神经网络的方面级情感分析方法，其特征在于，所述方法包括： 获取待进行方面情感分析的句子，以及该待进行方面情感分析句子中的方面词； 对所述待进行方面情感分析的句子以及所述方面词进行预处理，得到所述待进行方面 情感分析的句子对应的输入向量序列以及句法加权图；其中，所述输入向量序列用于表征 所述待进行方面情感分析句子的初始特征，所述初始特征包括所述方面词的相对距离信 息，所述句法加权图用于表征所述待进行方面情感分析句子中各个词之间的依存关系；

将所述输入向量序列和所述句法加权图，输入预先训练的双重图卷积神经网络中，得 到所述方面词对应的情感分析结果；其中，所述预先训练的双重图卷积神经网络包括：句法 图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络，所述句法图卷积子神经 网络用于提取所述待进行方面情感分析的句子对应的句法相关特征，所述基于自注意力机 制的语义图卷积子神经网络用于提取所述待进行方面情感分析的句子对应的语义相关特 征，所述预先训练的双重图卷积神经网络是根据样本句子对应的输入向量序列，样本句子 对应的句法加权图，以及样本句子中方面词对应的标准情感分析结果训练得到的，所述标 准情感分析结果包括：正向结果、中性结果以及负向结果。

2.根据权利要求1所述的方法，其特征在于，所述对所述待进行方面情感分析的句子以 及所述方面词进行预处理，得到所述待进行方面情感分析的句子对应的输入向量序列以及 句法加权图的步骤，包括：

使用预训练的Glove词嵌入，将所述待进行方面情感分析的句子中每个词转换为词向 量；

将所述待进行方面情感分析的句子中方面词的相对距离信息，以及每个词的词性信息 分别使用向量表示，并与所述词向量进行拼接，得到所述待进行方面情感分析的句子对应 的输入向量序列；

将所述待进行方面情感分析的句子中每个词的词性信息对应的向量和所述词向量，输 入预先训练的依存句法分析器中，得到所述待进行方面情感分析的句子对应的依赖弧概率 矩阵，并将所述依赖弧概率矩阵转换为句法加权图；所述预先训练的依存句法分析器是根 据预设数据集训练得到的。

3.根据权利要求1所述的方法，其特征在于，所述将所述输入向量序列和所述句法加权 图，输入预先训练的双重图卷积神经网络中，得到所述方面词对应的情感分析结果的步骤， 包括：

利用所述预先训练的双重图卷积神经网络中的双向长短期记忆网络BiLSTM，对所述输 入向量序列进行特征转换，得到所述待进行方面情感分析的句子对应的隐藏状态特征；

基于所述待进行方面情感分析的句子对应的隐藏状态特征以及句法加权图，利用所述 句法图卷积子神经网络，对所述待进行方面情感分析的句子进行句法特征提取，得到所述 待进行方面情感分析的句子对应的第一句法图特征；

基于所述待进行方面情感分析的句子对应的隐藏状态特征，利用所述基于自注意力机 制的语义图卷积子神经网络，对所述待进行方面情感分析的句子进行语义特征提取，得到 所述待进行方面情感分析的句子对应的第一语义图特征；

利用所述预先训练的双重图卷积神经网络中的双仿射模块，分别对所述待进行方面情 感分析的句子对应的第一句法图特征和第一语义图特征进行特征转换，得到所述待进行方

权 利 要 求 书 1/4 页

CN 112528672 A

面情感分析的句子对应的第二句法图特征和第二语义图特征；

分别提取所述待进行方面情感分析的句子对应的第二句法图特征和第二语义图特征 中的方面词节点特征，并利用所述预先训练的双重图卷积神经网络中的池化层，对提取的 方面词节点特征进行池化和拼接处理，得到第一拼接特征；

利用所述预先训练的双重图卷积神经网络中的全连接层，对所述第一拼接特征进行概 率分析，得到所述方面词对应的情感分析结果。

4.根据权利要求1‑3任一所述的方法，其特征在于，所述双重图卷积神经网络的训练过 程，包括：

构建初始双重图卷积神经网络模型，所述初始双重图卷积神经网络模型包括：双向长 短期记忆网络BiLSTM，句法图卷积子神经网络，基于自注意力机制的语义图卷积子神经网 络，双仿射模块，池化层和全连接层；

将样本句子对应的输入向量序列，输入至所述BiLSTM中，得到所述样本句子对应的隐 藏状态特征；

将所述样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入所述句法 图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征；

将所述样本句子对应的隐藏状态特征，输入所述基于自注意力机制的语义图卷积子神 经网络进行语义特征提取，得到样本句子对应的第一语义图特征；

利用所述双仿射模块，分别对所述样本句子对应的第一句法图特征和第一语义图特征 进行特征转换，得到所述样本句子对应的第二句法图特征和第二语义图特征；

分别提取所述样本句子对应的第二句法图特征和第二语义图特征中的方面词节点特 征，将提取的方面词节点特征输入池化层，进行池化和拼接处理，得到第二拼接特征；

将所述第二拼接特征输入全连接层，得到样本句子中方面词对应的情感分析结果； 基于所述情感分析结果与标准情感分析结果的差异，计算所述初始双重图卷积神经网 络模型对应的损失函数；

对所述损失函数进行最小化处理，确定所述初始双重图卷积神经网络模型中各模块的 权重参数；

基于所述初始双重图卷积神经网络模型中各模块的权重参数，对所述初始双重图卷积 神经网络模型中的参数进行更新，训练得到所述双重图卷积神经网络模型。

5.根据权利要求4所述的方法，其特征在于，所述句法图卷积子神经网络和基于自注意 力机制的语义图卷积子神经网络各包含N层，N为大于1的整数；

所述利用所述双仿射模块，分别对所述样本句子对应的第一句法图特征和第一语义图 特征进行特征转换，得到所述样本句子对应的第二句法图特征和第二语义图特征之后，还 包括：

将所述样本句子对应的第二句法图特征，更新为样本句子对应的隐藏状态特征，并执 行将所述样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入所述句法图 卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征的步骤；

将所述样本句子对应的第二语义图特征，更新为样本句子对应的隐藏状态特征，并执 行将所述样本句子对应的隐藏状态特征，输入所述基于自注意力机制的语义图卷积子神经 网络进行语义特征提取，得到样本句子对应的第一语义图特征的步骤。

权 利 要 求 书 2/4 页

CN 112528672 A

6.根据权利要求4所述的方法，其特征在于，所述损失函数的表达式为： lT＝lC+λ1RO+λ2RD+λ3||Θ||2

其中，lT表示损失函数，lC表示交叉熵损失，λ1、λ2和λ3表示正则项权重系数，RO表示正交 正则损失值，RD表示差异正则损失值，Θ表示所述双重图卷积神经网络模型中所有可训练 参数，Asem表示基于自注意力机制的语义图卷积子神经网络中自注意力机制对所述样本句 子进行注意力计算，得到的注意力得分矩阵，I表示单位矩阵，Asyn表示依赖弧概率矩阵。

7.一种基于图卷积神经网络的方面级情感分析装置，其特征在于，所述装置包括： 获取模块，用于获取待进行方面情感分析的句子，以及该待进行方面情感分析句子中 的方面词；

预处理模块，用于对所述待进行方面情感分析的句子以及所述方面词进行预处理，得 到所述待进行方面情感分析的句子对应的输入向量序列以及句法加权图；其中，所述输入 向量序列用于表征所述待进行方面情感分析句子的初始特征，所述初始特征包括所述方面 词的相对距离信息，所述句法加权图用于表征所述待进行方面情感分析句子中各个词之间 的依存关系；

情感分析模块，用于将所述输入向量序列和所述句法加权图，输入预先训练的双重图 卷积神经网络中，得到所述方面词对应的情感分析结果；其中，所述预先训练的双重图卷积 神经网络包括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络，所 述句法图卷积子神经网络用于提取所述待进行方面情感分析的句子对应的句法相关特征， 所述基于自注意力机制的语义图卷积子神经网络用于提取所述待进行方面情感分析的句 子对应的语义相关特征，所述预先训练的双重图卷积神经网络是根据样本句子对应的输入 向量序列，样本句子对应的句法加权图，以及样本句子中方面词对应的标准情感分析结果

训练得到的，所述标准情感分析结果包括：正向结果、中性结果以及负向结果。

8.根据权利要求7所述的装置，其特征在于，所述预处理模块，包括： 第一转换子模块，用于使用预训练的Glove词嵌入，将所述待进行方面情感分析的句子 中每个词转换为词向量；

拼接子模块，用于将所述待进行方面情感分析的句子中方面词的相对距离信息，以及 每个词的词性信息分别使用向量表示，并与所述词向量进行拼接，得到所述待进行方面情 感分析的句子对应的输入向量序列；

分析子模块，用于将所述待进行方面情感分析的句子中每个词的词性信息对应的向量 和所述词向量，输入预先训练的依存句法分析器中，得到所述待进行方面情感分析的句子 对应的依赖弧概率矩阵，并将所述依赖弧概率矩阵转换为句法加权图；所述预先训练的依 存句法分析器是根据预设数据集训练得到的。

9.一种电子设备，其特征在于，包括处理器、通信接口、存储器和通信总线，其中，处理 器，通信接口，存储器通过通信总线完成相互间的通信；

存储器，用于存放计算机程序；

权 利 要 求 书 3/4 页

CN 112528672 A

处理器，用于执行存储器上所存放的程序时，实现权利要求1‑6任一所述的方法步骤。 10.一种计算机可读存储介质，其特征在于，所述计算机可读存储介质内存储有计算机 程序，所述计算机程序被处理器执行时实现权利要求1‑6任一所述的方法步骤。

权 利 要 求 书 4/4 页

CN 112528672 A

一种基于图卷积神经网络的方面级情感分析方法及装置

[0001] 本发明涉及自然语言处理技术领域，特别是涉及一种基于图卷积神经网络的方面 级情感分析方法及装置。

[0002] ABSA(Aspect‑based Sentiment Analysis,基于方面的情感分析)是一个面向实 体级的细粒度情感分析任务，旨在判断句子中给定的方面词的情感极性。方面级情感分析 可以更加精确地识别出用户对一个具体方面的情感态度，而不是直接在句子级粒度上判断 情感极性。

[0003] 现有方面级情感分析使用的是基于句法依存树的GCN(Graph Convolution Network，图卷积网络)，具体的，将待进行方面情感分析的句子作为输入信息，使用预训练 的Glove词嵌入将该输入信息中的每个词转换为词向量，进而将词向量输入预先训练的 BiLSTM(Bidirectional Long Short‑Term Memory，双向长短期记忆网络)中，得到词向量 对应的隐藏状态特征，以及将输入信息输入预先训练的依存句法分析器中得到句法依存 树，并将句法依存树转换为包含待进行方面情感分析句子中各词的无向图，进一步将词向 量对应的隐藏状态特征、无向图，以及待进行方面情感分析的句子中方面词的位置信息，输 入预先训练的GCN中进行情感分析，得到待进行方面情感分析的句子中方面词所对应的情 感分析结果。

[0004] 然而，发明人发现，现有使用基于句法依存树的GCN实现方面级情感分析的过程 中，因依存句法分析器对句子的句法解析存在解析结果不准确的现象，以及当待进行情感 分析的句子对句法依赖不敏感时，使用依存句法分析器解析得到的句法依存树所转换的无 向图作为GCN的一项输入，使得通过GCN得到的情感分析结果不准确。

[0005] 本发明实施例的目的在于提供一种基于图卷积神经网络的方面级情感分析方法 及装置，以提高情感分析结果的准确性。具体技术方案如下：

[0006] 第一方面，本发明实施例提供了一种基于图卷积神经网络的方面级情感分析方 法，所述方法包括：

[0007] 获取待进行方面情感分析的句子，以及该待进行方面情感分析句子中的方面词；

[0008] 对所述待进行方面情感分析的句子以及所述方面词进行预处理，得到所述待进行 方面情感分析的句子对应的输入向量序列以及句法加权图；其中，所述输入向量序列用于 表征所述待进行方面情感分析句子的初始特征，所述初始特征包括所述方面词的相对距离 信息，所述句法加权图用于表征所述待进行方面情感分析句子中各个词之间的依存关系；

[0009] 将所述输入向量序列和所述句法加权图，输入预先训练的双重图卷积神经网络 中，得到所述方面词对应的情感分析结果；其中，所述预先训练的双重图卷积神经网络包 括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络，所述句法图卷

说 明 书 1/19 页

CN 112528672 A

积子神经网络用于提取所述待进行方面情感分析的句子对应的句法相关特征，所述基于自 注意力机制的语义图卷积子神经网络用于提取所述待进行方面情感分析的句子对应的语 义相关特征，所述预先训练的双重图卷积神经网络是根据样本句子对应的输入向量序列， 样本句子对应的句法加权图，以及样本句子中方面词对应的标准情感分析结果训练得到 的，所述标准情感分析结果包括：正向结果、中性结果以及负向结果。

[0010] 可选地，所述对所述待进行方面情感分析的句子以及所述方面词进行预处理，得 到所述待进行方面情感分析的句子对应的输入向量序列以及句法加权图的步骤，包括：

[0011] 使用预训练的Glove词嵌入，将所述待进行方面情感分析的句子中每个词转换为 词向量；

[0012] 将所述待进行方面情感分析的句子中方面词的相对距离信息，以及每个词的词性 信息分别使用向量表示，并与所述词向量进行拼接，得到所述待进行方面情感分析的句子 对应的输入向量序列；

[0013] 将所述待进行方面情感分析的句子中每个词的词性信息对应的向量和所述词向 量，输入预先训练的依存句法分析器中，得到所述待进行方面情感分析的句子对应的依赖 弧概率矩阵，并将所述依赖弧概率矩阵转换为句法加权图；所述预先训练的依存句法分析 器是根据预设数据集训练得到的。

[0014] 可选地，所述将所述输入向量序列和所述句法加权图，输入预先训练的双重图卷 积神经网络中，得到所述方面词对应的情感分析结果的步骤，包括：

[0015] 利用所述预先训练的双重图卷积神经网络中的双向长短期记忆网络BiLSTM，对所 述输入向量序列进行特征转换，得到所述待进行方面情感分析的句子对应的隐藏状态特 征；

[0016] 基于所述待进行方面情感分析的句子对应的隐藏状态特征以及句法加权图，利用 所述句法图卷积子神经网络，对所述待进行方面情感分析的句子进行句法特征提取，得到 所述待进行方面情感分析的句子对应的第一句法图特征；

[0017] 基于所述待进行方面情感分析的句子对应的隐藏状态特征，利用所述基于自注意 力机制的语义图卷积子神经网络，对所述待进行方面情感分析的句子进行语义特征提取， 得到所述待进行方面情感分析的句子对应的第一语义图特征；

[0018] 利用所述预先训练的双重图卷积神经网络中的双仿射模块，分别对所述待进行方 面情感分析的句子对应的第一句法图特征和第一语义图特征进行特征转换，得到所述待进 行方面情感分析的句子对应的第二句法图特征和第二语义图特征；

[0019] 分别提取所述待进行方面情感分析的句子对应的第二句法图特征和第二语义图 特征中的方面词节点特征，并利用所述预先训练的双重图卷积神经网络中的池化层，对提 取的方面词节点特征进行池化和拼接处理，得到第一拼接特征；

[0020] 利用所述预先训练的双重图卷积神经网络中的全连接层，对所述第一拼接特征进 行概率分析，得到所述方面词对应的情感分析结果。

[0021] 可选地，所述双重图卷积神经网络的训练过程，包括：

[0022] 构建初始双重图卷积神经网络模型，所述初始双重图卷积神经网络模型包括：双 向长短期记忆网络BiLSTM，句法图卷积子神经网络，基于自注意力机制的语义图卷积子神 经网络，双仿射模块，池化层和全连接层；

说 明 书 2/19 页

CN 112528672 A

[0023] 将样本句子对应的输入向量序列，输入至所述BiLSTM中，得到所述样本句子对应 的隐藏状态特征；

[0024] 将所述样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入所述 句法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征；

[0025] 将所述样本句子对应的隐藏状态特征，输入所述基于自注意力机制的语义图卷积 子神经网络进行语义特征提取，得到样本句子对应的第一语义图特征；

[0026] 利用所述双仿射模块，分别对所述样本句子对应的第一句法图特征和第一语义图 特征进行特征转换，得到所述样本句子对应的第二句法图特征和第二语义图特征；

[0027] 分别提取所述样本句子对应的第二句法图特征和第二语义图特征中的方面词节 点特征，将提取的方面词节点特征输入池化层，进行池化和拼接处理，得到第二拼接特征；

[0028] 将所述第二拼接特征输入全连接层，得到样本句子中方面词对应的情感分析结 果；

[0029] 基于所述情感分析结果与标准情感分析结果的差异，计算所述初始双重图卷积神 经网络模型对应的损失函数；

[0030] 对所述损失函数进行最小化处理，确定所述初始双重图卷积神经网络模型中各模 块的权重参数；

[0031] 基于所述初始双重图卷积神经网络模型中各模块的权重参数，对所述初始双重图 卷积神经网络模型中的参数进行更新，训练得到所述双重图卷积神经网络模型。

[0032] 可选地，所述句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网 络各包含N层，N为大于1的整数；

[0033] 所述利用所述双仿射模块，分别对所述样本句子对应的第一句法图特征和第一语 义图特征进行特征转换，得到所述样本句子对应的第二句法图特征和第二语义图特征之 后，还包括：

[0034] 将所述样本句子对应的第二句法图特征，更新为样本句子对应的隐藏状态特征， 并执行将所述样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入所述句 法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征的步骤；

[0035] 将所述样本句子对应的第二语义图特征，更新为样本句子对应的隐藏状态特征， 并执行将所述样本句子对应的隐藏状态特征，输入所述基于自注意力机制的语义图卷积子 神经网络进行语义特征提取，得到样本句子对应的第一语义图特征的步骤。

[0036] 可选地，所述损失函数的表达式为：

[0037] lT＝lC+λ1RO+λ2RD+λ3||Θ||2

[0038]

[0039]

[0040] 其中，lT表示损失函数，lC表示交叉熵损失，λ1、λ2和λ3表示正则项权重系数，RO表示 正交正则损失值，RD表示差异正则损失值，Θ表示所述双重图卷积神经网络模型中所有可 训练参数，Asem表示基于自注意力机制的语义图卷积子神经网络中自注意力机制对所述样 本句子进行注意力计算，得到的注意力得分矩阵，I表示单位矩阵，Asyn表示依赖弧概率矩 阵。

说 明 书 3/19 页

CN 112528672 A

[0041] 第二方面，本发明实施例提供了一种基于图卷积神经网络的方面级情感分析装 置，所述装置包括：

[0042] 获取模块，用于获取待进行方面情感分析的句子，以及该待进行方面情感分析句 子中的方面词；

[0043] 预处理模块，用于对所述待进行方面情感分析的句子以及所述方面词进行预处 理，得到所述待进行方面情感分析的句子对应的输入向量序列以及句法加权图；其中，所述 输入向量序列用于表征所述待进行方面情感分析句子的初始特征，所述初始特征包括所述 方面词的相对距离信息，所述句法加权图用于表征所述待进行方面情感分析句子中各个词 之间的依存关系；

[0044] 情感分析模块，用于将所述输入向量序列和所述句法加权图，输入预先训练的双 重图卷积神经网络中，得到所述方面词对应的情感分析结果；其中，所述预先训练的双重图 卷积神经网络包括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网 络，所述句法图卷积子神经网络用于提取所述待进行方面情感分析的句子对应的句法相关 特征，所述基于自注意力机制的语义图卷积子神经网络用于提取所述待进行方面情感分析 的句子对应的语义相关特征，所述预先训练的双重图卷积神经网络是根据样本句子对应的 输入向量序列，样本句子对应的句法加权图，以及样本句子中方面词对应的标准情感分析 结果训练得到的，所述标准情感分析结果包括：正向结果、中性结果以及负向结果。

[0045] 可选地，所述预处理模块，包括：

[0046] 第一转换子模块，用于使用预训练的Glove词嵌入，将所述待进行方面情感分析的 句子中每个词转换为词向量；

[0047] 拼接子模块，用于将所述待进行方面情感分析的句子中方面词的相对距离信息， 以及每个词的词性信息分别使用向量表示，并与所述词向量进行拼接，得到所述待进行方 面情感分析的句子对应的输入向量序列；

[0048] 分析子模块，用于将所述待进行方面情感分析的句子中每个词的词性信息对应的 向量和所述词向量，输入预先训练的依存句法分析器中，得到所述待进行方面情感分析的 句子对应的依赖弧概率矩阵，并将所述依赖弧概率矩阵转换为句法加权图；所述预先训练 的依存句法分析器是根据预设数据集训练得到的。

[0049] 可选地，情感分析模块，包括：

[0050] 第二转换子模块，用于利用所述预先训练的双重图卷积神经网络中的双向长短期 记忆网络BiLSTM，对所述输入向量序列进行特征转换，得到所述待进行方面情感分析的句 子对应的隐藏状态特征；

[0051] 第一特征提取子模块，用于基于所述待进行方面情感分析的句子对应的隐藏状态 特征以及句法加权图，利用所述句法图卷积子神经网络，对所述待进行方面情感分析的句 子进行句法特征提取，得到所述待进行方面情感分析的句子对应的第一句法图特征；

[0052] 第二特征提取子模块，用于基于所述待进行方面情感分析的句子对应的隐藏状态 特征，利用所述基于自注意力机制的语义图卷积子神经网络，对所述待进行方面情感分析 的句子进行语义特征提取，得到所述待进行方面情感分析的句子对应的第一语义图特征；

[0053] 第三转换子模块，用于利用所述预先训练的双重图卷积神经网络中的双仿射模 块，分别对所述待进行方面情感分析的句子对应的第一句法图特征和第一语义图特征进行

说 明 书 4/19 页

CN 112528672 A

特征转换，得到所述待进行方面情感分析的句子对应的第二句法图特征和第二语义图特 征；

[0054] 池化子模块，用于分别提取所述待进行方面情感分析的句子对应的第二句法图特 征和第二语义图特征中的方面词节点特征，并利用所述预先训练的双重图卷积神经网络中 的池化层，对提取的方面词节点特征进行池化和拼接处理，得到第一拼接特征；

[0055] 概率分析子模块，用于利用所述预先训练的双重图卷积神经网络中的全连接层， 对所述第一拼接特征进行概率分析，得到所述方面词对应的情感分析结果。

[0056] 可选地，所述装置还包括：

[0057] 构建模块，用于构建初始双重图卷积神经网络模型，所述初始双重图卷积神经网 络模型包括：双向长短期记忆网络BiLSTM，句法图卷积子神经网络，基于自注意力机制的语 义图卷积子神经网络，双仿射模块，池化层和全连接层；

[0058] 获得模块，用于将样本句子对应的输入向量序列，输入至所述BiLSTM中，得到所述 样本句子对应的隐藏状态特征；

[0059] 第一特征提取模块，用于将所述样本句子对应的隐藏状态特征以及样本句子对应 的句法加权图，输入所述句法图卷积子神经网络中进行句法特征提取，得到样本句子对应 的第一句法图特征；

[0060] 第二特征提取模块，用于将所述样本句子对应的隐藏状态特征，输入所述基于自 注意力机制的语义图卷积子神经网络进行语义特征提取，得到样本句子对应的第一语义图 特征；

[0061] 特征转换模块，用于利用所述双仿射模块，分别对所述样本句子对应的第一句法 图特征和第一语义图特征进行特征转换，得到所述样本句子对应的第二句法图特征和第二 语义图特征；

[0062] 池化模块，用于分别提取所述样本句子对应的第二句法图特征和第二语义图特征 中的方面词节点特征，将提取的方面词节点特征输入池化层，进行池化和拼接处理，得到第 二拼接特征；

[0063] 分析模块，用于将所述第二拼接特征输入全连接层，得到样本句子中方面词对应 的情感分析结果；

[0064] 计算模块，用于基于所述情感分析结果与标准情感分析结果的差异，计算所述初 始双重图卷积神经网络模型对应的损失函数；

[0065] 确定模块，用于对所述损失函数进行最小化处理，确定所述初始双重图卷积神经 网络模型中各模块的权重参数；

[0066] 训练模块，用于基于所述初始双重图卷积神经网络模型中各模块的权重参数，对 所述初始双重图卷积神经网络模型中的参数进行更新，训练得到所述双重图卷积神经网络 模型。

[0067] 可选地，所述句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网 络各包含N层，N为大于1的整数；所述装置还包括：

[0068] 第一更新模块，用于将所述样本句子对应的第二句法图特征，更新为样本句子对 应的隐藏状态特征，并执行将所述样本句子对应的隐藏状态特征以及样本句子对应的句法 加权图，输入所述句法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一

说 明 书 5/19 页

CN 112528672 A

句法图特征的步骤；

[0069] 第二更新模块，用于将所述样本句子对应的第二语义图特征，更新为样本句子对 应的隐藏状态特征，并执行将所述样本句子对应的隐藏状态特征，输入所述基于自注意力 机制的语义图卷积子神经网络进行语义特征提取，得到样本句子对应的第一语义图特征的 步骤。

[0070] 可选地，所述损失函数的表达式为：

[0071] lT＝lC+λ1RO+λ2RD+λ3||Θ||2

[0072]

[0073]

[0074] 其中，lT表示损失函数，lC表示交叉熵损失，λ1、λ2和λ3表示正则项权重系数，RO表示 正交正则损失值，RD表示差异正则损失值，Θ表示所述双重图卷积神经网络模型中所有可 训练参数，Asem表示基于自注意力机制的语义图卷积子神经网络中自注意力机制对所述样 本句子进行注意力计算，得到的注意力得分矩阵，I表示单位矩阵，Asyn表示依赖弧概率矩 阵。

[0075] 第三方面，本发明实施例提供了一种电子设备，其特征在于，包括处理器、通信接 口、存储器和通信总线，其中，处理器，通信接口，存储器通过通信总线完成相互间的通信；

[0076] 存储器，用于存放计算机程序；

[0077] 处理器，用于执行存储器上所存放的程序时，实现上述第一方面所述的方法步骤。

[0078] 第四方面，本发明实施例提供了一种计算机可读存储介质，其特征在于，所述计算 机可读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现实现上述第一 方面所述的方法步骤。

[0079] 本发明实施例有益效果：

[0080] 本发明实施例提供的一种基于图卷积神经网络的方面级情感分析方法及装置，因 预先训练的双重图卷积神经网络包括：句法图卷积子神经网络和基于自注意力机制的语义 图卷积子神经网络，而句法图卷积子神经网络用于提取待进行方面情感分析的句子对应的

句法相关特征，基于自注意力机制的语义图卷积子神经网络用于提取待进行方面情感分析 的句子对应的语义相关特征，使得双重图卷积神经网络不仅关注句子的句法特征，还关注

句子的语义特征，进而能够使用基于自注意力机制的语义图卷积子神经网络提取句子对应 的语义相关特征，以弥补对句法不敏感的句子提取句法特征不准确的缺陷，提高情感分析 结果的准确性。

[0081] 当然，实施本发明的任一产品或方法并不一定需要同时达到以上所述的所有优 点。

[0082] 为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现 有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本 发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以

说 明 书 6/19 页

CN 112528672 A

根据这些附图获得其他的附图。

[0083] 图1为本发明实施例提供的一种基于图卷积神经网络的方面级情感分析方法的流 程示意图；

[0084] 图2为本发明实施例提供的一种对待进行方面情感分析的句子以及方面词预处理 的实施方式流程示意图；

[0085] 图3为本发明实施例提供的一种对待进行方面情感分析的句子以及方面词分析的 结构示意图；

[0086] 图4为本发明实施例提供的一种获得方面词对应的情感分析结果的实施方式流程 示意图；

[0087] 图5为本发明实施例提供的一种双重图卷积神经网络模型的结构示意图；

[0088] 图6为本发明实施例提供的一种双重图卷积神经网络模型示意图；

[0089] 图7为本发明实施例提供的一种双重图卷积神经网络模型训练实施方式流程示意 图；

[0090] 图8为本发明实施例提供的一种基于图卷积神经网络的方面级情感分析装置的结 构示意图；

[0091] 图9为本发明实施例提供的一种电子设备的结构示意图。

具体实施方式

[0092] 下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完 整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于 本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他 实施例，都属于本发明保护的范围。

[0093] 首先，对图卷积神经网络进行介绍，GCN(Graph Convolutional Network，图卷积 神经网络)受传统的CNN(Convolutional Neural Network，卷积神经网络)和图嵌入的启 发，GCN是CNN的一种有效的变体，且可以直接在图上进行操作。GCN可以在直接连接的节点 上使用卷积操作，编码局部信息，通过多层的GCN消息传递，图中的每个节点可以学习更多 的全局信息。

[0094] 例如，给定一个具有n个节点的图，该图可以表示为一个邻接矩阵 进而

可以通过编码依存句法树和引入词之间的依赖路径来扩展GCN，从而增强GCN模型，以及可 以利用句子的句法依存句法树来构建邻接矩阵A，A中的元素Aij表示节点i是否与节点j相 连。具体地，如果Aij＝1表示节点i与节点j相连，Aij＝0则表示节点i与节点j不相连。另外， 邻接矩阵只由0和1组成，可以被视为依存句法分析器的最终离散输出。第l层的节点i的隐

藏状态可以表示为 通过下列公式进行更新节点表示：

[0095]

[0096] 其中，表示第l层的节点i的隐藏状态，σ表示激活函数，k表示第k个节点，j表示

第j个节点，Wl表示第l层的权重矩阵， 表示第l‑1层节点j的隐藏状态，bl表示第l层的一

说 明 书 7/19 页

CN 112528672 A

个偏置项，表示初始输入。

[0097] 为了解决现有使用基于句法依存树的GCN实现方面级情感分析的过程中，因依存 句法分析器对句子的句法解析存在解析结果不准确的现象，以及当待进行情感分析的句子 对句法依赖不敏感时，使用依存句法分析器解析得到的句法依存树所转换的无向图作为 GCN的一项输入，使得通过GCN得到的情感分析结果不准确的问题，本发明实施例提供了一 种基于图卷积神经网络的方面级情感分析方法，该方法包括：

[0098] 获取待进行方面情感分析的句子，以及该待进行方面情感分析句子中的方面词； 对上述待进行方面情感分析的句子以及方面词进行预处理，得到待进行方面情感分析的句 子对应的输入向量序列以及句法加权图；将输入向量序列和句法加权图，输入预先训练的 双重图卷积神经网络中，得到方面词对应的情感分析结果；其中，输入向量序列用于表征待 进行方面情感分析句子的初始特征，初始特征包括方面词的相对距离信息，句法加权图用 于表征待进行方面情感分析句子中各个词之间的依存关系；预先训练的双重图卷积神经网 络包括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络，句法图卷 积子神经网络用于提取待进行方面情感分析的句子对应的句法相关特征，基于自注意力机 制的语义图卷积子神经网络用于提取待进行方面情感分析的句子对应的语义相关特征，预 先训练的双重图卷积神经网络是根据样本句子对应的输入向量序列，样本句子对应的句法 加权图，以及样本句子中方面词对应的标准情感分析结果训练得到的，标准情感分析结果 包括：正向结果、中性结果以及负向结果。

[0099] 本发明实施例，因预先训练的双重图卷积神经网络包括：句法图卷积子神经网络 和基于自注意力机制的语义图卷积子神经网络，而句法图卷积子神经网络用于提取待进行 方面情感分析的句子对应的句法相关特征，基于自注意力机制的语义图卷积子神经网络用 于提取待进行方面情感分析的句子对应的语义相关特征，使得双重图卷积神经网络不仅关 注句子的句法特征，还关注句子的语义特征，进而能够使用基于自注意力机制的语义图卷 积子神经网络提取句子对应的语义相关特征，以弥补对句法不敏感的句子提取句法特征不 准确的缺陷，提高情感分析结果的准确性。

[0100] 下面进行具体说明，参见图1，图1为本发明实施例提供的一种基于图卷积神经网 络的方面级情感分析方法的流程示意图，该方法可以包括：

[0101] S101，获取待进行方面情感分析的句子，以及该待进行方面情感分析句子中的方 面词。

[0102] 本发明实施例基于图卷积神经网络的方面级情感分析方法可以通过电子设备实 现，具体的，该电子设备可以为个人电脑或服务器等。

[0103] 在需要对句子进行方面级情感分析时，可以获取待进行方面情感分析的句子，以 及该待进行方面情感分析句子中的方面词。其中，方面词可以是描述一个实体的不同属性 或方面的单词或词语，例如，关于餐饮行业的一条评论：The price is reasonable although the service is poor，价格合理但是服务不好，在该条评论中包含两个方面词： price和service，对应的观点词分别为reasonable和poor。又如，同样关于餐饮的一条评 论：The wine list is excellent，酒单极好，在该句子中包含一个方面词：wine list，对 应的观点词为excellent。

[0104] S102，对待进行方面情感分析的句子以及方面词进行预处理，得到待进行方面情

说 明 书 8/19 页

CN 112528672 A

感分析的句子对应的输入向量序列以及句法加权图。

[0105] 可以对待进行方面情感分析的句子中包含的词以及方面词进行预处理，得到待进 行方面情感分析的句子对应的输入向量序列以及句法加权图。其中，输入向量序列可以用 于表征待进行方面情感分析句子的初始特征，初始特征可以包括方面词的相对距离信息， 句法加权图可以用于表征待进行方面情感分析句子中各个词之间的依存关系。具体对待进 行方面情感分析的句子中包含的词以及方面词进行预处理的过程在下文详细介绍。

[0106] S103，将输入向量序列和句法加权图，输入预先训练的双重图卷积神经网络中，得 到方面词对应的情感分析结果。

[0107] 在对待进行方面情感分析的句子以及方面词进行预处理之后，可以进一步将得到 的待进行方面情感分析的句子对应的输入向量序列以及句法加权图，输入预先训练的双重 图卷积神经网络中进行方面词的情感分析，得到方面词对应的情感分析结果，该方面词对 应的情感分析结果可以包括：正向结果、中性结果以及负向结果。

[0108] 其中，预先训练的双重图卷积神经网络可以包括：句法图卷积子神经网络和基于 自注意力机制的语义图卷积子神经网络，句法图卷积子神经网络可以用于提取待进行方面 情感分析的句子对应的句法相关特征，基于自注意力机制的语义图卷积子神经网络可以用 于提取待进行方面情感分析的句子对应的语义相关特征。预先训练的双重图卷积神经网络 是根据样本句子对应的输入向量序列，样本句子对应的句法加权图，以及样本句子中方面 词对应的标准情感分析结果训练得到的，标准情感分析结果包括：正向结果、中性结果以及 负向结果。

[0109] 示例性的，针对待进行方面情感分析的句子：The price is reasonable although the service is poor中的方面词price，可以得到该方面词对应的情感分析结 果为正向结果，而针对待进行方面情感分析的句子：The price is reasonable although the service is poor中的方面词service，可以得到该方面词对应的情感分析结果为负向 结果。

[0110] 本发明实施例提供的基于图卷积神经网络的方面级情感分析方法，因预先训练的 双重图卷积神经网络包括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神 经网络，而句法图卷积子神经网络用于提取待进行方面情感分析的句子对应的句法相关特 征，基于自注意力机制的语义图卷积子神经网络用于提取待进行方面情感分析的句子对应 的语义相关特征，使得双重图卷积神经网络不仅关注句子的句法特征，还关注句子的语义 特征，进而能够使用基于自注意力机制的语义图卷积子神经网络提取句子对应的语义相关 特征，以弥补对句法不敏感的句子提取句法特征不准确的缺陷，提高情感分析结果的准确 性。

[0111] 在一种可能的实施方式中，参见图2，上述对待进行方面情感分析的句子以及方面 词进行预处理，得到待进行方面情感分析的句子对应的输入向量序列以及句法加权图的实 施方式，可以包括：

[0112] S1021，使用预训练的Glove词嵌入，将待进行方面情感分析的句子中每个词转换 为词向量。

[0113] 上述获取待进行方面情感分析的句子时，可以进一步获取该句子中所包含的每个 词对应的词性信息，以及获取待进行方面情感分析句子中的方面词时，可以进一步获取该

说 明 书 9/19 页

CN 112528672 A

方面词在句子中的位置信息或相对距离信息等。其中，方面词在句子中的位置信息可以用 于标识方面词在句子中的具体位置，方面词在句子中的相对距离信息可以用于标识方面词 相对该句子中其他词的位置信息。

[0114] 示例性的，如图3所示，针对待进行方面情感分析的句子：The price is reasonable although the service is poor，可以对该句子进行分词，得到“The”， “price”， “is”， “reasonable”， “although”， “the”， “service”， “is”， “poor”，以及可以对该 句子中每个词对应的词性信息依次进行标注为：限定词、名词、动词、形容词、连接词、限定 词、名词、动词、形容词，该句子中的方面词包含price和service，每次可以针对一个方面 词，例如针对方面词price，该方面词在句子中的位置信息可以表示为：[0,1,0,0,0,0,0,0, 0,0]，相对距离信息可以表示为：[‑1,0,1,2,3,4,5,6,7,8]等。

[0115] 进而可以使用预训练的Glove词嵌入，将待进行方面情感分析的句子中每个词转 换为词向量。其中，预训练的Glove词嵌入可以为现有的Glove词嵌入，用于将待进行方面情 感分析的句子中每个词使用向量表示，即将待进行方面情感分析的句子中每个词转换为词 向量。

[0116] 示例性的，获取的待进行方面情感分析的句子，以及该待进行方面情感分析句子 中的方面词可以表示为：(a,s)，(a,s)即方面词句子对，其中，a表示句子s中的方面词，方面 词的集合可以表示为：a＝{a1,a2,...,am}，a是句子s＝{w1,w2,...,wn}的子序列，am表示句 子s中的第m个方面词，wn表示句子s中的第n个词。进而使用预训练的Glove词嵌入，将待进 行方面情感分析的句子中每个词转换为词向量可以表示为：x＝{x1,x2,...,xn}，xn表示第n 个词对应的词向量。

[0117] S1022，将待进行方面情感分析的句子中方面词的相对距离信息，以及每个词的词 性信息分别使用向量表示，并与词向量进行拼接，得到待进行方面情感分析的句子对应的 输入向量序列。

[0118] 将待进行方面情感分析的句子中方面词的相对距离信息，以及每个词的词性信息 可以分别使用向量表示。其中，每个词的词性信息可以使用词性标记符号表示，例如，限定 词、名词、动词、形容词、连接词、限定词、名词、动词、形容词依次可以表示为：DT，NN，VBZ， JJ，IN，DT，NN，VBZ，JJ，进而将DT，NN，VBZ，JJ，IN，DT，NN，VBZ，JJ使用向量表示。

[0119] 进一步的，将待进行方面情感分析的句子中方面词的相对距离信息向量，每个词 的词性信息向量，与上述词向量进行拼接，得到待进行方面情感分析的句子对应的输入向 量序列，该输入向量序列可以用于表征待进行方面情感分析句子的初始特征，可以理解的， 该初始特征包括了方面词的相对距离信息，以及待进行方面情感分析的句子中每个词的词 性信息、每个词对应的词向量。

[0120] S1023，将待进行方面情感分析的句子中每个词的词性信息对应的向量和词向量， 输入预先训练的依存句法分析器中，得到待进行方面情感分析的句子对应的依赖弧概率矩 阵，并将依赖弧概率矩阵转换为句法加权图。

[0121] 本发明实施例中，可以使用预先训练的依存句法分析器，建立待进行方面情感分 析的句子中各个词之间的联系，该预先训练的依存句法分析器可以是根据预设数据集训练 得到的，该预设数据集可以是PTB(English Penn Tree‑bank，英文宾州树库)数据集等。

[0122] 本发明实施例中，将待进行方面情感分析的句子中每个词的词性信息对应的向量

说 明 书 10/19 页

CN 112528672 A

和上述得到的词向量，输入预先训练的依存句法分析器中，得到待进行方面情感分析的句 子对应的依赖弧概率矩阵。如图3所示，方面词price和观点词reasonable之间有一条依赖 关系，方面词service和观点词poor之间有一条依赖关系等，进而将各个词之间的依赖关系 使用依赖弧概率矩阵表示。进一步的，将依赖弧概率矩阵转换为句法加权图，该句法加权图 可以是无向加权图，句法加权图中每一节点即为待进行方面情感分析的句子中的每个词。

[0123] 本发明实施例中，利用依存句法分析器，得到待进行方面情感分析的句子对应的 依赖弧概率矩阵，而不是依存句法分析器最终输出的0/1形式的离散值，进而将该依赖弧概 率矩阵所对应的句法加权图，作为分析待进行方面情感分析的句子中方面词情感的一个依 据，且句法加权图可以表征待进行方面情感分析的句子中各个词之间的依赖关系，与依存 句法分析器最终离散的输出相比，依赖弧概率矩阵可以提供潜在的句法结构，能够表达更 丰富的句法信息，进而能够减轻依存句法分析器对句子的句法解析不准确的现象，提高情 感分析结果的准确性。

[0124] 在一种可能的实施方式中，参见图4，上述将输入向量序列和句法加权图，输入预 先训练的双重图卷积神经网络中，得到方面词对应的情感分析结果的实施方式，可以包括：

[0125] S1031，利用预先训练的双重图卷积神经网络中的双向长短期记忆网络BiLSTM，对 输入向量序列进行特征转换，得到待进行方面情感分析的句子对应的隐藏状态特征。

[0126] 如图5 所示，本发明实施例中，双重图卷积神经网络可以包括：B i L S T M (Bidirectional Long Short‑Term Memory，双向长短期记忆网络)，句法图卷积子神经网 络，基于自注意力机制的语义图卷积子神经网络，双仿射模块，池化层以及全连接层。

[0127] 在得到待进行方面情感分析的句子对应的输入向量序列以及句法加权图之后，利 用预先训练的双重图卷积神经网络中的双向长短期记忆网络BiLSTM，对输入向量序列进行 特征转换可以是：将输入向量序列输入双重图卷积神经网络中的BiLSTM，对输入向量序列 进行特征转换，得到待进行方面情感分析的句子对应的隐藏状态特征，其中，BiLSTM能够捕 捉各个词在句子中的上下文依赖关系，BiLSTM的维度本领域技术人员可根据实际需求进行 设置。示例性的，所得到的待进行方面情感分析的句子对应的隐藏状态特征所对应的序列 可以表示为H＝{h1,h2,...,hn}，hn表示第n个词所对应的隐藏状态特征表示。

[0128] S1032，基于待进行方面情感分析的句子对应的隐藏状态特征以及句法加权图，利 用句法图卷积子神经网络，对待进行方面情感分析的句子进行句法特征提取，得到待进行 方面情感分析的句子对应的第一句法图特征。

[0129] 基于待进行方面情感分析的句子对应的隐藏状态特征以及句法加权图，利用句法 图卷积子神经网络，对待进行方面情感分析的句子进行句法特征提取，得到待进行方面情 感分析的句子对应的第一句法图特征的过程可以是：将待进行方面情感分析的句子对应的 隐藏状态特征以及句法加权图作为输入，输入至句法图卷积子神经网络中，对待进行方面 情感分析的句子进行句法特征提取，得到待进行方面情感分析的句子对应的第一句法图特 征的输出。利用句法图卷积子神经网络，可以捕获待进行方面情感分析的句子中各个词之 间的依赖关系。

[0130] 具体的，句法加权图输入至句法图卷积子神经网络中，可以形成一个邻接矩阵

将从BiLSTM输出的待进行方面情感分析的句子对应的隐藏状态特征向量序

列H作为句法图中节点的初始表示，通过以下公式，从句法图卷积子神经网络中得到待进行

说 明 书 11/19 页

CN 112528672 A

方面情感分析的句子对应的第一句法图特征(即句子中每个词的句法特征)表示可以为：

其中 表示句法图卷积子神经网络中节点i的句法隐

藏表示，使用 表示方面词节点的句法隐藏表示。

[0131]

[0132] S1033，基于待进行方面情感分析的句子对应的隐藏状态特征，利用基于自注意力 机制的语义图卷积子神经网络，对待进行方面情感分析的句子进行语义特征提取，得到待 进行方面情感分析的句子对应的第一语义图特征。

[0133] 基于待进行方面情感分析的句子对应的隐藏状态特征，利用基于自注意力机制的 语义图卷积子神经网络，对待进行方面情感分析的句子进行语义特征提取，得到待进行方 面情感分析的句子对应的第一语义图特征的过程可以是：将待进行方面情感分析的句子对 应的隐藏状态特征作为输入，输入至自注意力机制的语义图卷积子神经网络，对待进行方 面情感分析的句子进行语义特征提取，得到待进行方面情感分析的句子对应的第一语义图 特征。

[0134] 自注意力可以并行地计算基于自注意力机制的语义图卷积子神经网络中每一对

元素的注意力得分，将一个自注意力层计算得到的句子的注意力得分矩阵

作为基于自注意力机制的语义图卷积子神经网络的邻接矩阵，具体的，通过如下公式计算 注意力得分矩阵Asem：

[0135]

[0136]

[0137] 其中，Q和K均等于基于自注意力机制的语义图卷积子神经网络前一层的图表示， WQ和WK均表示可学习的参数权重矩阵，dk表示缩放系数，d表示输入节点特征的维度，g表示 注意力通道数，T表示转置。示例性的，可以使用其中一个注意力通道的自注意力来得到句 子的注意力得分矩阵。从基于自注意力机制的语义图卷积子神经网络中得到待进行方面情 感分析的句子对应的第一语义图特征(即句子中每个词的语义特征) 表示可以为：

其中 表示基于自注意力机制的语义图卷积子神经网

络中节点i的语义隐藏表示，使用 表示方面词节点的语义隐藏表示。

[0138] 本发明实施例中，通过自注意力机制将得到的注意力得分矩阵作为邻接矩阵，自 注意力可以捕捉句子中每个词的语义相关项，能够更好地对句法信息不敏感的数据提取语 义相关特征。

[0139] S1034，利用预先训练的双重图卷积神经网络中的双仿射模块，分别对待进行方面 情感分析的句子对应的第一句法图特征和第一语义图特征进行特征转换，得到待进行方面 情感分析的句子对应的第二句法图特征和第二语义图特征。

[0140] 利用预先训练的双重图卷积神经网络中的双仿射模块，分别对待进行方面情感分

说 明 书 12/19 页

CN 112528672 A

析的句子对应的第一句法图特征和第一语义图特征进行特征转换，得到待进行方面情感分 析的句子对应的第二句法图特征和第二语义图特征的过程可以是：将待进行方面情感分析 的句子对应的第一句法图特征和第一语义图特征作为输入，输入至双仿射模块，对待进行 方面情感分析的句子对应的第一句法图特征和第一语义图特征进行特征转换，得到待进行 方面情感分析的句子对应的第二句法图特征和第二语义图特征。

[0141] 本发明实施例中，利用一个相互的双仿射转换过程在句法图卷积子神经网络和基 于自注意力机制的语义图卷积子神经网络之间桥接信息流，交换相关特征。示例性的，计算 过程可以如下：

[0142] Hsyn′＝softmax(HsynW1HsemT)Hsem

[0143] Hsem′＝softmax(HsemW2HsynT)Hsyn

[0144] (Hsyn′,Hsem′)＝Biaffine(Hsyn,Hsem)

[0145] 其中，Hsyn′表示第二句法图特征，Hsyn表示第一句法图特征，Hsem′表示第二语义图特 征，Hsem表示第一语义图特征，W1和W2表示两个可训练的参数，(Hsyn′,Hsem′)表示通过双仿射 桥接的第二句法图特征和第二语义图特征。

[0146] S1035，分别提取待进行方面情感分析的句子对应的第二句法图特征和第二语义 图特征中的方面词节点特征，并利用预先训练的双重图卷积神经网络中的池化层，对提取 的方面词节点特征进行池化和拼接处理，得到第一拼接特征。

[0147] 如图6所示，待进行方面情感分析的句子对应的输入向量序列中包含方面词的相 对距离信息，进而可以根据方面词的相对距离信息，解析得到方面词的位置信息，进一步可 以根据方面词的位置信息分别提取得到待进行方面情感分析的句子对应的第二句法图特 征和第二语义图特征中的方面词节点特征，利用池化层，对提取的方面词节点特征进行池 化和拼接处理，得到第一拼接特征。

[0148] 示例性的，针对待进行方面情感分析的句子The wine list is excellent，方面 词为wine list，进而可以分别提取待进行方面情感分析的句子对应的第二句法图特征和 第二语义图特征中的方面词节点wine list的特征，对提取的方面词节点特征进行池化和 拼接处理。具体的，可以使用如下公式，对提取的方面词节点特征进行池化和拼接处理：

[0149]

[0150]

[0151]

[0152] 其中， 表示对待进行方面情感分析的句子对应的第二句法图特征中方面词节

点a的平均池化处理，f(·)表示平均池化函数， 表示待进行方面情感分析

的句子中各方面词节点的句法隐藏表示， 表示对待进行方面情感分析的句子对应的第

二语义图特征中方面词节点a的平均池化处理， 表示待进行方面情感分析

的句子中各方面词节点的语义隐藏表示，r表示第一拼接特征，[,]表示拼接操作。

[0153] S1036，利用预先训练的双重图卷积神经网络中的全连接层，对第一拼接特征进行 概率分析，得到方面词对应的情感分析结果。

说 明 书 13/19 页

CN 112528672 A

[0154] 利用双重图卷积神经网络中的全连接层，对从池化层得到的第一拼接特征进行概 率分析，得到方面词对应的情感分析结果。具体的，如图6所示，将从池化层得到的第一拼接 特征输入全连接层，经过softmax分类器产生一个关于方面词a情感极性的概率分布p，p(a) ＝softmax(Wpr+bp)，其中，Wp和bp分别表示可学习的权重和偏置，r表示第一拼接特征。

[0155] 本发明实施例中，使用双重图卷积神经网络，对待进行方面情感分析的句子中方 面词进行情感分析，可以更加精确地识别出用户对于一个具体方面的情感态度，而不是直 接在句子级粒度上判断情感极性。且，句法图卷积子神经网络可以用于提取待进行方面情 感分析的句子对应的句法相关特征，基于自注意力机制的语义图卷积子神经网络可以用于 提取待进行方面情感分析的句子对应的语义相关特征，使得双重图卷积神经网络不仅关注 句子的句法特征，还关注句子的语义特征，进而能够使用基于自注意力机制的语义图卷积 子神经网络提取句子对应的语义相关特征，以弥补对句法不敏感的句子提取句法特征不准 确的缺陷，提高情感分析结果的准确性。

[0156] 本发明实施例还提供了一种双重图卷积神经网络的训练方法，参见图7，该方法可 以包括：

[0157] S201，构建初始双重图卷积神经网络模型。

[0158] 如图5所示，本发明实施例中，构建的初始双重图卷积神经网络模型可以包括：双 向长短期记忆网络BiLSTM，句法图卷积子神经网络，基于自注意力机制的语义图卷积子神 经网络，双仿射模块，池化层和全连接层等。

[0159] S202，将样本句子对应的输入向量序列，输入至BiLSTM中，得到样本句子对应的隐 藏状态特征。

[0160] 本发明实施例中，可以采用上述获取待进行方面情感分析的句子，以及该待进行 方面情感分析句子中的方面词，并对待进行方面情感分析的句子以及方面词进行预处理， 得到待进行方面情感分析的句子对应的输入向量序列以及句法加权图的实施方式，获取样 本句子对应的输入向量序列和句法加权图。具体的，样本句子的选取，可以是任何行业任意 句子。

[0161] 进而，将样本句子对应的输入向量序列，输入至BiLSTM中，对样本句子对应的输入 向量序列进行特征转换，得到样本句子对应的隐藏状态特征。

[0162] S203，将样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入句 法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征。

[0163] S204，将样本句子对应的隐藏状态特征，输入基于自注意力机制的语义图卷积子 神经网络进行语义特征提取，得到样本句子对应的第一语义图特征。

[0164] S205，利用双仿射模块，分别对样本句子对应的第一句法图特征和第一语义图特 征进行特征转换，得到样本句子对应的第二句法图特征和第二语义图特征。

[0165] S206，分别提取样本句子对应的第二句法图特征和第二语义图特征中的方面词节 点特征，将提取的方面词节点特征输入池化层，进行池化和拼接处理，得到第二拼接特征。

[0166] S207，将第二拼接特征输入全连接层，得到样本句子中方面词对应的情感分析结 果。

[0167] 上述步骤S203‑S207的实现过程，可参照上述步骤S1032‑S1036的具体实现过程， 本发明实施例在此不再赘述。

说 明 书 14/19 页

CN 112528672 A

[0168] S208，基于情感分析结果与标准情感分析结果的差异，计算初始双重图卷积神经 网络模型对应的损失函数。

[0169] 在一种可能的实施方式中，本发明实施例中损失函数的表达式可以为：

[0170] lT＝lC+λ1RO+λ2RD+λ3||Θ||2

[0171]

[0172]

[0173] 其中，lT表示损失函数，lC表示交叉熵损失，λ1、λ2和λ3表示正则项权重系数，RO表示 正交正则损失值，RD表示差异正则损失值，Θ表示双重图卷积神经网络模型中所有可训练 参数，Asem表示基于自注意力机制的语义图卷积子神经网络中自注意力机制对样本句子进 行注意力计算，得到的注意力得分矩阵，I表示单位矩阵，Asyn表示依赖弧概率矩阵。

[0174] 本发明实施例中，提出了两种正则化，即正交正则和差异正则，目的是为了限制基 于自注意力机制的语义图卷积子神经网络中的邻接矩阵捕获到的有效的语义信息。

[0175] 实际应用中，同一个句子中每个词的语义相关项应该分布在句子中的不同部分， 因此，基于自注意力机制的语义图卷积子神经网络中注意力得分的分布应该很少重叠。正 交正则的作用是将句子中所有词的注意力得分向量尽量趋于正交化，因此每个词会关注到

不同的相关项。假设注意力得分矩阵记为 正交正则计算可以如下：

[0176]

[0177] 这样，可以通过最小化每个非对角线上的元素达到正交的目的。

[0178] 从句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络中，学习 到的两种特征表示分别为第一句法图特征和第一语义图特征，第一句法图特征和第一语义 图特征分别包含在句法依赖和语义相关性两个不同层次的特征表示。在句法图卷积子神经 网络和基于自注意力机制的语义图卷积子神经网络的邻接矩阵之间应用一个差异正则项， 约束第一句法图特征和第一语义图特征之间的差异性，该差异正则项可以表示如下，实质 上，该差异正则项只对Asem约束。

[0179]

[0180] 交叉熵损失lC可以表示如下：

[0181]

[0182] 其中，表示包含所有方面词句子对(a ,s)的集合，表示不同情感极性的集合，c

表示情感极性，p(a)即为全连接层输出的方面词a情感极性的概率分布。

[0183] S209，对损失函数进行最小化处理，确定初始双重图卷积神经网络模型中各模块 的权重参数。

[0184] S2010，基于初始双重图卷积神经网络模型中各模块的权重参数，对初始双重图卷 积神经网络模型中的参数进行更新，训练得到双重图卷积神经网络模型。

[0185] 上述步骤S209～S2010中，对损失函数进行最小化处理，确定初始双重图卷积神经

说 明 书 15/19 页

CN 112528672 A

网络模型中各模块的权重参数，进而基于初始双重图卷积神经网络模型中各模块的权重参 数，对初始双重图卷积神经网络模型中的参数进行更新，训练得到双重图卷积神经网络模 型。此过程的详细实现过程，可参见现有技术的实现，本发明实施例在此不再赘述。

[0186] 在一种可能的实施方式中，本发明实施例中的句法图卷积子神经网络和基于自注 意力机制的语义图卷积子神经网络可以各包含N层，N为大于1的整数，如图6所示。相应的，

[0187] 上述利用双仿射模块，分别对样本句子对应的第一句法图特征和第一语义图特征 进行特征转换，得到样本句子对应的第二句法图特征和第二语义图特征之后，还包括以下 操作：

[0188] 将样本句子对应的第二句法图特征，更新为样本句子对应的隐藏状态特征，并执 行将样本句子对应的隐藏状态特征以及样本句子对应的句法加权图，输入句法图卷积子神 经网络中进行句法特征提取，得到样本句子对应的第一句法图特征的步骤。

[0189] 以及，将样本句子对应的第二语义图特征，更新为样本句子对应的隐藏状态特征， 并执行将样本句子对应的隐藏状态特征，输入基于自注意力机制的语义图卷积子神经网络 进行语义特征提取，得到样本句子对应的第一语义图特征的步骤。

[0190] 相应于上述方法实施例，本发明实施例提供了一种基于图卷积神经网络的方面级 情感分析装置，如图8所示，该装置可以包括：

[0191] 获取模块301，用于获取待进行方面情感分析的句子，以及该待进行方面情感分析 句子中的方面词。

[0192] 预处理模块302，用于对待进行方面情感分析的句子以及方面词进行预处理，得到 待进行方面情感分析的句子对应的输入向量序列以及句法加权图；其中，输入向量序列用 于表征待进行方面情感分析句子的初始特征，初始特征包括方面词的相对距离信息，句法 加权图用于表征待进行方面情感分析句子中各个词之间的依存关系。

[0193] 情感分析模块303，用于将输入向量序列和句法加权图，输入预先训练的双重图卷 积神经网络中，得到方面词对应的情感分析结果；其中，预先训练的双重图卷积神经网络包 括：句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络，句法图卷积子 神经网络用于提取待进行方面情感分析的句子对应的句法相关特征，基于自注意力机制的 语义图卷积子神经网络用于提取待进行方面情感分析的句子对应的语义相关特征，预先训 练的双重图卷积神经网络是根据样本句子对应的输入向量序列，样本句子对应的句法加权 图，以及样本句子中方面词对应的标准情感分析结果训练得到的，标准情感分析结果包括： 正向结果、中性结果以及负向结果。

[0194] 本发明实施例，因预先训练的双重图卷积神经网络包括：句法图卷积子神经网络 和基于自注意力机制的语义图卷积子神经网络，而句法图卷积子神经网络用于提取待进行 方面情感分析的句子对应的句法相关特征，基于自注意力机制的语义图卷积子神经网络用 于提取待进行方面情感分析的句子对应的语义相关特征，使得双重图卷积神经网络不仅关 注句子的句法特征，还关注句子的语义特征，进而能够使用基于自注意力机制的语义图卷 积子神经网络提取句子对应的语义相关特征，以弥补对句法不敏感的句子提取句法特征不 准确的缺陷，提高情感分析结果的准确性。

[0195] 可选地，上述预处理模块302，可以包括：

[0196] 第一转换子模块，用于使用预训练的Glove词嵌入，将待进行方面情感分析的句子

说 明 书 16/19 页

CN 112528672 A

中每个词转换为词向量。拼接子模块，用于将待进行方面情感分析的句子中方面词的相对 距离信息，以及每个词的词性信息分别使用向量表示，并与词向量进行拼接，得到待进行方 面情感分析的句子对应的输入向量序列。分析子模块，用于将待进行方面情感分析的句子 中每个词的词性信息对应的向量和词向量，输入预先训练的依存句法分析器中，得到待进 行方面情感分析的句子对应的依赖弧概率矩阵，并将依赖弧概率矩阵转换为句法加权图； 预先训练的依存句法分析器是根据预设数据集训练得到的。

[0197] 可选地，上述情感分析模块303，可以包括：

[0198] 第二转换子模块，用于利用预先训练的双重图卷积神经网络中的双向长短期记忆 网络BiLSTM，对输入向量序列进行特征转换，得到待进行方面情感分析的句子对应的隐藏 状态特征。第一特征提取子模块，用于基于待进行方面情感分析的句子对应的隐藏状态特 征以及句法加权图，利用句法图卷积子神经网络，对待进行方面情感分析的句子进行句法 特征提取，得到待进行方面情感分析的句子对应的第一句法图特征。第二特征提取子模块， 用于基于待进行方面情感分析的句子对应的隐藏状态特征，利用基于自注意力机制的语义 图卷积子神经网络，对待进行方面情感分析的句子进行语义特征提取，得到待进行方面情 感分析的句子对应的第一语义图特征。第三转换子模块，用于利用预先训练的双重图卷积 神经网络中的双仿射模块，分别对待进行方面情感分析的句子对应的第一句法图特征和第 一语义图特征进行特征转换，得到待进行方面情感分析的句子对应的第二句法图特征和第 二语义图特征。池化子模块，用于分别提取待进行方面情感分析的句子对应的第二句法图 特征和第二语义图特征中的方面词节点特征，并利用预先训练的双重图卷积神经网络中的 池化层，对提取的方面词节点特征进行池化和拼接处理，得到第一拼接特征。概率分析子模 块，用于利用预先训练的双重图卷积神经网络中的全连接层，对第一拼接特征进行概率分 析，得到方面词对应的情感分析结果。

[0199] 可选地，上述装置还可以包括：

[0200] 构建模块，用于构建初始双重图卷积神经网络模型，初始双重图卷积神经网络模 型包括：双向长短期记忆网络BiLSTM，句法图卷积子神经网络，基于自注意力机制的语义图 卷积子神经网络，双仿射模块，池化层和全连接层。

[0201] 获得模块，用于将样本句子对应的输入向量序列，输入至BiLSTM中，得到样本句子 对应的隐藏状态特征。

[0202] 第一特征提取模块，用于将样本句子对应的隐藏状态特征以及样本句子对应的句 法加权图，输入句法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句 法图特征。

[0203] 第二特征提取模块，用于将样本句子对应的隐藏状态特征，输入基于自注意力机 制的语义图卷积子神经网络进行语义特征提取，得到样本句子对应的第一语义图特征。

[0204] 特征转换模块，用于利用双仿射模块，分别对样本句子对应的第一句法图特征和 第一语义图特征进行特征转换，得到样本句子对应的第二句法图特征和第二语义图特征。

[0205] 池化模块，用于分别提取样本句子对应的第二句法图特征和第二语义图特征中的 方面词节点特征，将提取的方面词节点特征输入池化层，进行池化和拼接处理，得到第二拼 接特征。

[0206] 分析模块，用于将第二拼接特征输入全连接层，得到样本句子中方面词对应的情

说 明 书 17/19 页

CN 112528672 A

感分析结果。

[0207] 计算模块，用于基于情感分析结果与标准情感分析结果的差异，计算初始双重图 卷积神经网络模型对应的损失函数。

[0208] 确定模块，用于对损失函数进行最小化处理，确定初始双重图卷积神经网络模型 中各模块的权重参数。

[0209] 训练模块，用于基于初始双重图卷积神经网络模型中各模块的权重参数，对初始 双重图卷积神经网络模型中的参数进行更新，训练得到双重图卷积神经网络模型。

[0210] 可选地，句法图卷积子神经网络和基于自注意力机制的语义图卷积子神经网络各 包含N层，N为大于1的整数。上述装置还可以包括：

[0211] 第一更新模块，用于将样本句子对应的第二句法图特征，更新为样本句子对应的 隐藏状态特征，并执行将样本句子对应的隐藏状态特征以及样本句子对应的句法加权图， 输入句法图卷积子神经网络中进行句法特征提取，得到样本句子对应的第一句法图特征的 步骤。

[0212] 第二更新模块，用于将样本句子对应的第二语义图特征，更新为样本句子对应的 隐藏状态特征，并执行将样本句子对应的隐藏状态特征，输入基于自注意力机制的语义图 卷积子神经网络进行语义特征提取，得到样本句子对应的第一语义图特征的步骤。

[0213] 可选地，损失函数的表达式为：

[0214] lT＝lC+λ1RO+λ2RD+λ3||Θ||2

[0215]

[0216]

[0217] 其中，lT表示损失函数，lC表示交叉熵损失，λ1、λ2和λ3表示正则项权重系数，RO表示 正交正则损失值，RD表示差异正则损失值，Θ表示双重图卷积神经网络模型中所有可训练 参数，Asem表示基于自注意力机制的语义图卷积子神经网络中自注意力机制对样本句子进 行注意力计算，得到的注意力得分矩阵，I表示单位矩阵，Asyn表示依赖弧概率矩阵。

[0218] 本发明实施例还提供了一种电子设备，如图9所示，包括处理器401、通信接口402、 存储器403和通信总线404，其中，处理器401，通信接口402，存储器403通过通信总线404完 成相互间的通信，

[0219] 存储器403，用于存放计算机程序；

[0220] 处理器401，用于执行存储器403上所存放的程序时，实现本申请中任一一种基于 图卷积神经网络的方面级情感分析的步骤。

[0221] 上述电子设备提到的通信总线可以是P C I (P e r i p h e r a l C o m p o n e n t Interconnect，外设部件互连标准) 总线或EISA(Extended Industry Standard Architecture，扩展工业标准结构)总线等。该通信总线可以分为地址总线、数据总线、控制 总线等。为便于表示，图中仅用一条粗线表示，但并不表示仅有一根总线或一种类型的总 线。

[0222] 通信接口用于上述电子设备与其他设备之间的通信。

[0223] 存储器可以包括RAM(Random Access Memory，随机存取存储器)，也可以包括NVM

说 明 书 18/19 页

CN 112528672 A

(Non‑Volatile Memory，非易失性存储器)，例如至少一个磁盘存储器。可选的，存储器还可 以是至少一个位于远离前述处理器的存储装置。

[0224] 上述的处理器可以是通用处理器，包括CPU(Central Processing Unit，中央处理 器)、NP(Network Processor，网络处理器)等；还可以是DSP(Digital Signal Processing， 数字信号处理器)、ASIC(Application Specific Integrated Circuit，专用集成电路)、 FPGA(Field‑Programmable Gate Array，现场可编程门阵列)或者其他可编程逻辑器件、分 立门或者晶体管逻辑器件、分立硬件组件。

[0225] 在本发明提供的又一实施例中，还提供了一种计算机可读存储介质，该计算机可 读存储介质内存储有计算机程序，所述计算机程序被处理器执行时实现上述任一一种基于 图卷积神经网络的方面级情感分析方法的步骤。

[0226] 在本发明提供的又一实施例中，还提供了一种包含指令的计算机程序产品，当其 在计算机上运行时，使得计算机执行上述实施例中任一一种基于图卷积神经网络的方面级 情感分析方法。

[0227] 在上述实施例中，可以全部或部分地通过软件、硬件、固件或者其任意组合来实 现。当使用软件实现时，可以全部或部分地以计算机程序产品的形式实现。所述计算机程序 产品包括一个或多个计算机指令。在计算机上加载和执行所述计算机程序指令时，全部或 部分地产生按照本发明实施例所述的流程或功能。所述计算机可以是通用计算机、专用计 算机、计算机网络、或者其他可编程装置。所述计算机指令可以存储在计算机可读存储介质 中，或者从一个计算机可读存储介质向另一个计算机可读存储介质传输，例如，所述计算机 指令可以从一个网站站点、计算机、服务器或数据中心通过有线(例如同轴电缆、光纤、数字 用户线(DSL))或无线(例如红外、无线、微波等)方式向另一个网站站点、计算机、服务器或 数据中心进行传输。所述计算机可读存储介质可以是计算机能够存取的任何可用介质或者 是包含一个或多个可用介质集成的服务器、数据中心等数据存储设备。所述可用介质可以 是磁性介质，(例如，软盘、硬盘、磁带)、光介质(例如，DVD)、或者半导体介质(例如固态硬盘 Solid State Disk(SSD))等。

[0228] 需要说明的是，在本文中，诸如第一和第二等之类的关系术语仅仅用来将一个实 体或者操作与另一个实体或操作区分开来，而不一定要求或者暗示这些实体或操作之间存 在任何这种实际的关系或者顺序。而且，术语“包括”、 “包含”或者其任何其他变体意在涵盖 非排他性的包含，从而使得包括一系列要素的过程、方法、物品或者设备不仅包括那些要 素，而且还包括没有明确列出的其他要素，或者是还包括为这种过程、方法、物品或者设备 所固有的要素。在没有更多限制的情况下，由语句“包括一个……”限定的要素，并不排除在 包括所述要素的过程、方法、物品或者设备中还存在另外的相同要素。

[0229] 本说明书中的各个实施例均采用相关的方式描述，各个实施例之间相同相似的部 分互相参见即可，每个实施例重点说明的都是与其他实施例的不同之处。尤其，对于装置、 电子设备的实施例而言，由于其基本相似于方法实施例，所以描述的比较简单，相关之处参

见方法实施例的部分说明即可。

[0230] 以上所述仅为本发明的较佳实施例，并非用于限定本发明的保护范围。凡在本发 明的精神和原则之内所作的任何修改、等同替换、改进等，均包含在本发明的保护范围内。

说 明 书 19/19 页

CN 112528672 A

说 明 书 附 图 1/5 页

CN 112528672 A

说 明 书 附 图 2/5 页

CN 112528672 A

说 明 书 附 图 3/5 页

CN 112528672 A

说 明 书 附 图 4/5 页

CN 112528672 A

说 明 书 附 图 5/5 页

CN 112528672 A